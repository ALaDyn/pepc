 HELP = "\
\# Makefile for gcc 4.8 (self-compiled via the following commands)\n\
\# \n\
\# svn checkout svn://gcc.gnu.org/svn/gcc/trunk workspace/gcc\n\
\# cd workspace/gcc\n\
\# ./configure --prefix=/home5/m.winkel/programs/gcc/ -enable-gold=yes --enable-lto --disable-checking --enable-languages=c,c++,fortran --enable-multiarch --enable-shared --enable-threads=posix --without-included-gettext --with-system-zlib --with-tune=generic\n\
\# make -j 6\n\
\# make install\n\
\# export PATH=${HOME}/programs/gcc/bin:${PATH}\n\
\# export I_MPI_CC=gcc\n\
\# export I_MPI_F90=gfortran\n\
"

MACH     = linux_gcc-4.8

DEBUG    = 1
OMP      = 1

RANLIB   = ranlib

MAKE     = make

AR       = ar
ARFLAGS  = -rs

CPP      = mpicc
CPPFLAGS = -E -x c -P -C -ffreestanding
                       # ^----- this prevents errors due to nasty automatic pre-inclusion of stdc-predefs.h when using cpp for fortran code

INLINING = -flto -fuse-linker-plugin  \
	   -mstringop-strategy=unrolled_loop -fipa-matrix-reorg \
	   -u run_communication_loop -u walk_worker_thread

FWARNINGS = -Wall -Wconversion -Warray-temporaries -Wcharacter-truncation -Wline-truncation
FFEATURES = -frecursive -fimplicit-none -ffree-line-length-none -fcoarray=none -fsign-zero

ifeq ($(DEBUG), 1)
  FFLAGS   = -Og -g -gdwarf-3 \
    -fcheck=all -frange-check -fbacktrace -fvar-tracking \
    $(FFEATURES) \
    $(FWARNINGS)
  CFLAGS   = -Og -g -gdwarf-3 -pthread -Wall
  LDFLAGS  = -Og -g -gdwarf-3 -pthread
else
  FFLAGS   = -Ofast \
    $(INLINING) \
    $(FFEATURES) \
    $(FWARNINGS)
  CFLAGS   = -Ofast -pthread -Wall
  LDFLAGS  = -Ofast -pthread $(INLINING)
  CPPFLAGS += -DNDEBUG
endif

ifeq ($(OMP), 1)
  FFLAGS   += -fopenmp
  LDFLAGS  += -fopenmp
  # Use Intel OpenMP runtime
  #LDFLAGS  += -lirc -liomp5 -lpthread -lc -L/usr/local_64/intel/Composer/composer_xe_2013_sp1.2.144/compiler/lib/intel64
else
endif

FCPRE    =
FC       = mpif90

CCPRE    =
CC       = mpicc

LDPRE    =
LD       = mpif90
LDLIBS   =

RM       = rm -rf

COMPILER = $(shell $(FC) --version | head -n 1)
