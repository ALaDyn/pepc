# Makefile for gcc 4.7 (self-compiled via the following commands)
#
# wget
#ftp://ftp.mpi-sb.mpg.de/pub/gnu/mirror/gcc.gnu.org/pub/gcc/releases/gcc-4.6.1/gcc-4.6.1.tar.gz
# untar to workspace/gcc
# cd workspace/gcc
# ./configure --enable-bootstrap --prefix=/lustre/jhome2/jzam04/jzam0415/programs/gcc/ --enable-gold=yes --enable-lto --disable-checking --enable-languages=c,c++,fortran --enable-multiarch --enable-shared --enable-threads=posix --with-gmp=/lustre/jhome2/jzam04/jzam0415/programs/gmp --with-mpc=/lustre/jhome2/jzam04/jzam0415/programs/mpc --with-mpfr=/lustre/jhome2/jzam04/jzam0415/programs/mpfr --without-included-gettext --with-system-zlib --with-tune=generic
# make -j 8
# make install
# export PATH=${HOME}/programs/gcc/bin:${PATH}
# export LD_LIBRARY_PATH=${HOME}/programs/gcc/lib64:${LD_LIBRARY_PATH}


MACH     = Juropa_gcc-4.6.1

DEBUG    = 0

RANLIB   = ranlib

MAKE     = make

AR       = ar
ARFLAGS  = -rs

CPP      = cpp
CPPFLAGS = -P -C

INLINING = -fdump-ipa-inline -finline-functions-called-once -fearly-inlining -findirect-inlining -mstringop-strategy=unrolled_loop -flto-partition=none -finline-limit=120000 --param large-function-insns=120000 --param large-unit-insns=120000 --param large-function-growth=1000 --param inline-unit-growth=1000 --param max-inline-insns-recursive-auto=120000 --param max-inline-recursive-depth-auto=500 -fipa-matrix-reorg 

# -flto
#-fwhopr

FCPRE    = 
FC       = mpif90
ifeq ($(DEBUG), 1)
  FFLAGS   = -Wall -O0 -pg -g -frecursive -ffree-line-length-none -frange-check -fbacktrace -fvar-tracking -pthread -C -Wconversion -fimplicit-none -Warray-temporaries -Wcharacter-truncation -Wline-truncation -fbacktrace -fcheck=all
  CFLAGS   = -Wall -O0 -pg -g 
  LDFLAGS  =       -O0 -pg -g 
else
  FFLAGS   = -Wall -O5 -pg    -frecursive  -ffree-line-length-none -fsign-zero -fno-protect-parens $(INLINING)
  CFLAGS   = -Wall -O5 -pg
  LDFLAGS   = -pthread -pg -O5 $(INLINING) -fwhole-program  
#-Wl,--threads
#-fuse-linker-plugin
endif

CCPRE    = 
CC       = mpicc

LDPRE    = 
LD       = mpif90
LDLIBS   = 

RM       = rm -rf

EXECNAME = ../pepc


