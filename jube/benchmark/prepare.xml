<preparation>

<!-- ******************************************************************************** -->

<prepare cname="PEPC">

  <precommand>(if test ! -f ./input/trajectory.ref.$geom.$npart.$nt.dat; then touch ./input/trajectory.ref.$geom.$npart.$nt.dat; fi)</precommand> 

  <input files="input/run.h.jube input/collectData.sh.jube" />

  <substitute infile="run.h.jube" outfile="run.h">
    <sub from="#NPART#"     to="$npart" />
    <sub from="#GEOM#"      to="$geom" />
    <sub from="#WSCHEME#"   to="$wscheme" />
    <sub from="#NT#"        to="$nt" />
    <sub from="#NPMULT#"    to="$npmult" />
    <sub from="#FETCHMULT#" to="$fetchmult" /> 
  </substitute>

  <!-- collect script -->
  <substitute infile="collectData.sh.jube" outfile="collectData.sh">
    <sub from="#BENCHHOME#"             to="$benchhome" />
    <sub from="#EXECUTABLE#"            to="pepc.exe" />

    <sub from="#PERL#"                  to="$PERL_CMD" />
    
    <sub from="#COLLECT_IHPCT_HWC#"     to="`index('$IHPCT_HWC','on')>-1     ? ' ' : '#'`" />
    <sub from="#COLLECT_IHPCT_MPITR#"   to="`index('$IHPCT_MPITR','on')>-1   ? ' ' : '#'`" />
    <sub from="#COLLECT_GPROF#"         to="`index('$GPROF','on')>-1         ? ' ' : '#'`" />
    <sub from="#COLLECT_CRAYPAT#"       to="`index('$CRAYPAT','on')>-1       ? ' ' : '#'`" />
    <sub from="#JUGENE#"                to="`index('$platform','Jugene')>-1  ? ' ' : '#'`" />
    <sub from="#JUMP#"                  to="`index('$platform','Jump')>-1    ? ' ' : '#'`" />
    <sub from="#HUYGENS#"               to="`index('$platform','Huygens')>-1 ? ' ' : '#'`" />
    <sub from="#LOUHI#"                 to="`index('$platform','Louhi')>-1   ? ' ' : '#'`" />
  </substitute>

  <command>(ln -s $benchhome/input/trajectory.ref.$geom.$npart.$nt.dat $outdir/trajectory.ref.dat)</command> 

</prepare>

<!-- ******************************************************************************** -->

<!-- ******************************************************************************** -->

</preparation>



