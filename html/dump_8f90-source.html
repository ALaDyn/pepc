<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PEPC: dump.f90 Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7-20060810 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_28272fc65e3d756317163f9acb2ad644.html">gibbon</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e3e416c1e3f7ebc92335d37fb0dd4777.html">pepc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_991097dbe07e9883c0a11fa77543783e.html">pepc-b</a></div>
<h1>dump.f90</h1><a href="dump_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 ! ======================
<a name="l00002"></a>00002 !
<a name="l00003"></a>00003 !   DUMP
<a name="l00004"></a>00004 !
<a name="l00005"></a>00005 !   Gather and write out particle data <span class="keywordflow">for</span> <a class="code" href="namelist_8h.html#2bdedf3cae2a62acd8af28e53daed9c0">restart</a> 
<a name="l00006"></a>00006 !
<a name="l00007"></a>00007 !
<a name="l00008"></a>00008 ! ======================
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="dump_8f90.html#88b597631f796e2b06c577e64bd94fe9">00010</a> subroutine <a class="code" href="dump_8f90.html#88b597631f796e2b06c577e64bd94fe9">dump</a>(timestamp)
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013   use physvars
<a name="l00014"></a>00014   use treevars
<a name="l00015"></a>00015   implicit none   
<a name="l00016"></a>00016   include 'mpif.h'
<a name="l00017"></a>00017 
<a name="l00018"></a>00018   character(30) :: cfile
<a name="l00019"></a>00019   character(6) :: cdump
<a name="l00020"></a>00020   character(5) :: cme
<a name="l00021"></a>00021   integer, intent(in) :: timestamp
<a name="l00022"></a>00022   integer :: i, j, ioffset, idummy=0, <a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>
<a name="l00023"></a>00023   integer, save :: icall=0
<a name="l00024"></a>00024   real :: simtime
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 
<a name="l00027"></a>00027   simtime = <a class="code" href="namelist_8h.html#a3753cec73bb5fd57684e7692a606f05">dt</a>*timestamp
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030   ! get filename suffix from <a class="code" href="dump_8f90.html#88b597631f796e2b06c577e64bd94fe9">dump</a> counter
<a name="l00031"></a>00031   do i=0,4
<a name="l00032"></a>00032      cdump(6-i:6-i) =  achar(mod(timestamp/10**i,10) + 48)  
<a name="l00033"></a>00033   end do
<a name="l00034"></a>00034   cdump(1:1) = achar(timestamp/10**5 + 48)
<a name="l00035"></a>00035 
<a name="l00036"></a>00036   cfile="data/pe"<span class="comment">//csubme//"/parts_info."//cdump(1:6)</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a>00039   open (60,file=cfile)    
<a name="l00040"></a>00040   write(60,'(7(a9,i8/),10(a9,f12.5/),9(a9,1pe12.5/),2(a9,3(1pe12.5)/))')  &amp;    ! info block
<a name="l00041"></a>00041        '<a class="code" href="namespacephysvars.html#c125a4e0d163ae9c82706249ee8ddee4">itime</a>=',timestamp, '<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>=',npp, &amp;
<a name="l00042"></a>00042        '<a class="code" href="namelist_8h.html#c570850af67b707ee0fabd68903062f7">ne</a>=',ne, '<a class="code" href="namelist_8h.html#a4fb44be053c6d3f35c09963f7ac2ecc">ni</a>=',ni, 'npbeam=',<a class="code" href="namelist_8h.html#deca65d6402d6c23fe9933bf421a948f">np_beam</a>, 'geometry=', <a class="code" href="namelist_8h.html#65b106175d5c7acd554c1bce2595f2a8">target_geometry</a>, &amp;
<a name="l00043"></a>00043        '<a class="code" href="namelist_8h.html#0650627b79fc23e2652232fe09854e4f">scheme</a>=',scheme, &amp;
<a name="l00044"></a>00044        '<a class="code" href="namelist_8h.html#b8c12579d5380e3cd3777e1c2a43d242">xl</a>=',xl, '<a class="code" href="namelist_8h.html#920848accbcb0bcb52d1d0d8c31eda24">yl</a>=',yl, '<a class="code" href="namelist_8h.html#6fd88682b343fc37fa3c1e56f0c3a194">zl</a>=',zl, '<a class="code" href="namespacetreevars.html#8b7d0bfaafb4911e08470411d32719f7">boxsize</a>=',zl, &amp;
<a name="l00045"></a>00045        '<a class="code" href="namelist_8h.html#3d5b0f2d79621403cfab74bce3469eb1">eps</a>=', eps, '<a class="code" href="namelist_8h.html#2debd5e81fbe9e3985b18628f622d180">theta</a>=',theta,' <a class="code" href="namespacephysvars.html#ce7ee718a38bd3f477f9ac537f245cdc">tlaser</a>= ',tlaser,' <a class="code" href="namespacephysvars.html#f7fa5a2635732bfa872faaf10f901450">trun</a>= ',trun, &amp;
<a name="l00046"></a>00046        '<a class="code" href="namelist_8h.html#630bc314dbc10cc6306033525170d456">omega</a>=',omega,'<a class="code" href="namelist_8h.html#e3d8df362ba9db761c5b2c3c47bd26f5">lambda</a>=',lambda,'  <a class="code" href="namespacephysvars.html#660f77759b5a6e2cdb0d84fbea454316">qe</a>=',qe,'  <a class="code" href="namespacephysvars.html#6bdbc3c85d95127570179f88965c5db3">qi</a>=',qi, &amp;
<a name="l00047"></a>00047        '<a class="code" href="namespacephysvars.html#2944045ce0b8cf406828839a2e61efd0">mass_e</a>=',mass_e,'<a class="code" href="namespacephysvars.html#b76e4caaac2dc9df8a2af1aaf10979fd">mass_i</a>=',mass_i,'<a class="code" href="namelist_8h.html#e20fb86f913bc05e1aa5bd022543b8a6">Zion</a>=',Zion,'<a class="code" href="namespacephysvars.html#12475503cd099fb76e2a93fab616f798">a_ii</a>=',a_ii, &amp;
<a name="l00048"></a>00048        '<a class="code" href="namespacephysvars.html#40a958ee25625f4ceb7850ff54207714">Vplas</a>=',Vplas,'<a class="code" href="namespacephysvars.html#bd3ef00da9082e85f7e93ab770c02753">Aplas</a>=',Aplas,'<a class="code" href="namespacephysvars.html#f496963d8d4a8fe5a5a8ea1fbcd77dae">Qplas</a>=',Qplas, &amp;
<a name="l00049"></a>00049        'centre=',<a class="code" href="namespacephysvars.html#571dce92e015cd998aa38c8dee7c36ac">plasma_centre</a>(1:3),'<a class="code" href="namelist_8h.html#a729632262bf53dac77d4fbe3047cb44">focus</a>=',focus(1:3)
<a name="l00050"></a>00050   
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>.eq.0) then
<a name="l00053"></a>00053 
<a name="l00054"></a>00054     cfile="parts_info.in"     ! copy to default <a class="code" href="namelist_8h.html#2bdedf3cae2a62acd8af28e53daed9c0">restart</a> block
<a name="l00055"></a>00055     open (61,file=cfile)    
<a name="l00056"></a>00056     write(61,'(7(a9,i8/),10(a9,f12.5/),9(a9,1pe12.5/),2(a9,3(1pe12.5)/))')  &amp;    ! info block
<a name="l00057"></a>00057        'itime=',timestamp, 'npp=',npp, &amp;
<a name="l00058"></a>00058        'ne=',ne, 'ni=',ni, 'npbeam=',np_beam, 'geometry=', target_geometry, &amp;
<a name="l00059"></a>00059        'scheme=',scheme, &amp;
<a name="l00060"></a>00060        'xl=',xl, 'yl=',yl, 'zl=',zl, 'boxsize=',zl, &amp;
<a name="l00061"></a>00061        'eps=', eps, 'theta=',theta,' tlaser= ',tlaser,' trun= ',trun, &amp;
<a name="l00062"></a>00062        'omega=',omega,'lambda=',lambda,'  qe=',qe,'  qi=',qi, &amp;
<a name="l00063"></a>00063        'mass_e=',mass_e,'mass_i=',mass_i,'Zion=',Zion,'a_ii=',a_ii, &amp;
<a name="l00064"></a>00064        'Vplas=',Vplas,'Aplas=',Aplas,'Qplas=',Qplas, &amp;
<a name="l00065"></a>00065        'centre=',plasma_centre(1:3),'focus=',focus(1:3)
<a name="l00066"></a>00066   
<a name="l00067"></a>00067     close (61)
<a name="l00068"></a>00068     open (62,file="runstamp")  ! time <a class="code" href="stamp_8f90.html#7d33a851eafcbd1b3c3d816862822c18">stamp</a> 
<a name="l00069"></a>00069     write(62,'(a)') cdump(1:6)
<a name="l00070"></a>00070     close (62)
<a name="l00071"></a>00071 
<a name="l00072"></a>00072   write(6,'(<span class="comment">//a/7(a9,i8/),10(a9,f12.5/),9(a9,1pe12.5/),2(a9,3(1pe12.5)/))') 'PARTICLE DUMP:', &amp;    ! info block</span>
<a name="l00073"></a>00073        'itime=',timestamp, 'npp=',npp, &amp;
<a name="l00074"></a>00074        'ne=',ne, 'ni=',ni, 'npbeam=',np_beam, 'geometry=', target_geometry, &amp;
<a name="l00075"></a>00075        'scheme=',scheme, &amp;
<a name="l00076"></a>00076        'xl=',xl, 'yl=',yl, 'zl=',zl, 'boxsize=',zl, &amp;
<a name="l00077"></a>00077        'eps=', eps, 'theta=',theta,' tlaser= ',tlaser,' trun= ',trun, &amp;
<a name="l00078"></a>00078        'omega=',omega,'lambda=',lambda,'  qe=',qe,'  qi=',qi, &amp;
<a name="l00079"></a>00079        'mass_e=',mass_e,'mass_i=',mass_i,'Zion=',Zion,'a_ii=',a_ii, &amp;
<a name="l00080"></a>00080        'Vplas=',Vplas,'Aplas=',Aplas,'Qplas=',Qplas, &amp;
<a name="l00081"></a>00081        'centre=',plasma_centre(1:3),'focus=',focus(1:3)
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   endif
<a name="l00084"></a>00084   close(60)
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   
<a name="l00088"></a>00088   cfile="data/pe"<span class="comment">//csubme//"/parts_dump."//cdump(1:6)</span>
<a name="l00089"></a>00089   open (60,file=cfile) 
<a name="l00090"></a>00090   write(60,'((12(1pe14.5),2i9))')  &amp;
<a name="l00091"></a>00091        (<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i), <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(i), <a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(i), <a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(i), <a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(i), <a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(i), <a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(i), <a class="code" href="namespacetreevars.html#6c12d2901c45a88c6f838e61074b3577">m</a>(i), &amp;
<a name="l00092"></a>00092         <a class="code" href="namespacetreevars.html#965b464677536c91c1aa7d309b77487f">Ex</a>(i), <a class="code" href="namespacetreevars.html#eb08655fc8ee445e48c5c52cb334a4a3">Ey</a>(i), <a class="code" href="namespacetreevars.html#5a7f29cfd6e9c687628d324991fecf3a">Ez</a>(i), &amp;  ! electric field
<a name="l00093"></a>00093         <a class="code" href="namespacetreevars.html#7854e9096568a9ed5efc8ce23a9d463f">pot</a>(i), &amp;  ! potential
<a name="l00094"></a>00094         <a class="code" href="namespacetreevars.html#6f1233e9ba9d5552e1b9dcec0fe6565d">pepid</a>(i), <a class="code" href="namespacetreevars.html#745c67b70193cf25d51284647d7731d6">pelabel</a>(i),i=1,npp)
<a name="l00095"></a>00095   close(60)
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   icall = icall + 1
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 end subroutine <a class="code" href="dump_8f90.html#88b597631f796e2b06c577e64bd94fe9">dump</a>
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 23 16:02:49 2007 for PEPC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7-20060810 </small></address>
</body>
</html>
