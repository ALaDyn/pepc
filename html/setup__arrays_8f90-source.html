<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PEPC: setup_arrays.f90 Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7-20060810 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_28272fc65e3d756317163f9acb2ad644.html">gibbon</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e3e416c1e3f7ebc92335d37fb0dd4777.html">pepc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_991097dbe07e9883c0a11fa77543783e.html">pepc-b</a></div>
<h1>setup_arrays.f90</h1><a href="setup__arrays_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="setup__arrays_8f90.html#0cf6dd14568818a43f895129c78550a2">00001</a> subroutine <a class="code" href="setup__arrays_8f90.html#0cf6dd14568818a43f895129c78550a2">setup_arrays</a>
<a name="l00002"></a>00002   use physvars
<a name="l00003"></a>00003   implicit none
<a name="l00004"></a>00004   include 'mpif.h'
<a name="l00005"></a>00005   integer :: mem_fields, npmax
<a name="l00006"></a>00006 
<a name="l00007"></a>00007   npmax = <a class="code" href="namespacephysvars.html#09f5cde25165ac570993c11da8af5944">npart_total</a>/<a class="code" href="namespacephysvars.html#f4969b110a8dac1d6ed43e3af45647a4">n_cpu</a>*3
<a name="l00008"></a>00008   allocate ( <a class="code" href="namespacephysvars.html#0e97c4ec26a828bbd295ec0fa22c9ba8">xslice</a>(npmax), <a class="code" href="namespacephysvars.html#d8610c1a1089552ac1e3492889a714c2">yslice</a>(npmax), <a class="code" href="namespacephysvars.html#ca1ae673c77947b9bb85dd65cecbbfd1">zslice</a>(npmax), <a class="code" href="namespacephysvars.html#f66e2ab7bfd214f6272b6c3d2f87e938">uxslice</a>(npmax), <a class="code" href="namespacephysvars.html#53f54f1481269e43aabf6a008dbcf9cc">uyslice</a>(npmax), <a class="code" href="namespacephysvars.html#eece82bec4ca6e5a98be5789461ca447">uzslice</a>(npmax), &amp; 
<a name="l00009"></a>00009        <a class="code" href="namespacephysvars.html#7b9c063bc72f8ee3ef072ddce5212b33">qslice</a>(npmax), <a class="code" href="namespacephysvars.html#a731cd40a7380282a9e1960ec777e330">mslice</a>(npmax) )    ! Reserve slice particle array space N/NPE
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 
<a name="l00012"></a>00012   mem_fields = npmax*(8*8)
<a name="l00013"></a>00013 
<a name="l00014"></a>00014   allocate (<a class="code" href="namespacephysvars.html#a2f7912f37b0068ae111c3a0e2e7ff45">rhoi</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1),<a class="code" href="namespacephysvars.html#4147e84155f5211b95eb3f4097f49960">rhoe</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1))  ! global field arrays
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 ! local field arrays <span class="keywordflow">for</span> cycle-averages
<a name="l00017"></a>00017   allocate (<a class="code" href="namespacephysvars.html#ae4aa37acdf89c9a125d3f49378ad1a7">rhoe_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#5c6d6671f234daf211e86960d22511ec">rhoi_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), &amp;
<a name="l00018"></a>00018       <a class="code" href="namespacephysvars.html#7a1c0fca86c2bc62e75efe1647b01f34">ex_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#76369f69b98807541e81462f8d8ad9ce">ey_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1),  <a class="code" href="namespacephysvars.html#06132c0ebecee5de9d0b970b4ec3734b">ez_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), &amp;
<a name="l00019"></a>00019       <a class="code" href="namespacephysvars.html#b6e9eb2e6fa5064b2e7a2781452ad41b">bx_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#fc4e5c461b934f57753ceea39f7a5a06">by_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1),  <a class="code" href="namespacephysvars.html#89b6b00973c2f1d2e2848ff550945686">bz_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), &amp;
<a name="l00020"></a>00020       <a class="code" href="namespacephysvars.html#a70d74e55eaabb298c7b170e694e7575">Te_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#7d4354b5c0426fcbe5bc1500e0da45b2">Ti_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1),  &amp;
<a name="l00021"></a>00021       <a class="code" href="namespacephysvars.html#e1d7acbcbc2f76563f55de6fc2e20712">g_ele</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#18510feefd5a32366d2a872a9d9849d7">g_ion</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1),  &amp;
<a name="l00022"></a>00022       <a class="code" href="namespacephysvars.html#70d9723a3b15e62bb82255e9176f67d6">jxe_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#32c31509040c8711dc0d4e2a977caea1">jye_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1), <a class="code" href="namespacephysvars.html#cdbb75baabdde34c8b1e0f86e110e4e3">jze_loc</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1,0:<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>+1,0:<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a>+1) )
<a name="l00023"></a>00023   allocate (<a class="code" href="namespacephysvars.html#f5a5074b56b36fce9f3f2779119a836a">ex_ave</a>(0:<a class="code" href="namelist_8h.html#273d3bff8b18ec89e78a20f7428c0d91">ngx</a>+1),<a class="code" href="namespacephysvars.html#274b1cca1e9a8ec80010d8d54c42161e">ey_ave</a>(0:ngx+1),<a class="code" href="namespacephysvars.html#4ea40f73555292913316d5a5a17dac24">ez_ave</a>(0:ngx+1))
<a name="l00024"></a>00024 
<a name="l00025"></a>00025   mem_fields = mem_fields + ngx*<a class="code" href="namelist_8h.html#8882200f4d32762fb9a07ef67dcc9507">ngy</a>*<a class="code" href="namelist_8h.html#25424c1a15fb43612baeb74b653c7f58">ngz</a> * (8*13)
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 ! particle buffers for visualisation
<a name="l00029"></a>00029 
<a name="l00030"></a>00030   allocate (<a class="code" href="namespacephysvars.html#43c6ce3805ca8a02b237e8202e2c6c12">vbuffer</a>(0:<a class="code" href="namespacephysvars.html#6f68375eb9f50878b024caea10adb0bd">attrib_max</a>-1,<a class="code" href="namelist_8h.html#b2fa35d45849f7f192f3a139bb955c57">nbuf_max</a>), <a class="code" href="namespacephysvars.html#d3a3c593695d39f5a92015259674bba7">vbuf_local</a>(0:attrib_max-1,nbuf_max))
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   if (<a class="code" href="namespacephysvars.html#0decf2aea2fce458b260b471e6478e55">my_rank</a>==0) then
<a name="l00033"></a>00033      write(*,'(<span class="comment">//a/)') 'Initial memory allocation:'</span>
<a name="l00034"></a>00034      write(*,'(1(a15,f12.3,a3/)/)') 'Fields:',mem_fields/1.e6,' MB'
<a name="l00035"></a>00035   endif
<a name="l00036"></a>00036 
<a name="l00037"></a>00037   <a class="code" href="namespacephysvars.html#f5a5074b56b36fce9f3f2779119a836a">ex_ave</a>=0.
<a name="l00038"></a>00038   <a class="code" href="namespacephysvars.html#274b1cca1e9a8ec80010d8d54c42161e">ey_ave</a>=0.
<a name="l00039"></a>00039   <a class="code" href="namespacephysvars.html#4ea40f73555292913316d5a5a17dac24">ez_ave</a>=0.
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 end subroutine <a class="code" href="setup__arrays_8f90.html#0cf6dd14568818a43f895129c78550a2">setup_arrays</a>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 23 16:02:50 2007 for PEPC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7-20060810 </small></address>
</body>
</html>
