<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PEPC: treevars.f90 Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7-20060810 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_28272fc65e3d756317163f9acb2ad644.html">gibbon</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e3e416c1e3f7ebc92335d37fb0dd4777.html">pepc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_445afc100a243ec0eaed19e4a2dc673c.html">lpepcsrc</a></div>
<h1>treevars.f90</h1><a href="treevars_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 !
<a name="l00002"></a>00002 !   Header module <span class="keywordflow">for</span> treemp: global arrays and variables
<a name="l00003"></a>00003 !
<a name="l00004"></a>00004 !   $ Revision:   $ 
<a name="l00005"></a>00005 !   All key variables defined 64 bit (8 byte)
<a name="l00006"></a>00006 !
<a name="l00007"></a>00007  
<a name="l00008"></a><a class="code" href="namespacetreevars.html">00008</a> module treevars
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 !  implicit none
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 ! fixed array sizes <span class="keywordflow">for</span> debugging
<a name="l00014"></a>00014 !  integer, <a class="code" href="namespacetreevars.html#9d9579ed68e8c2570f66523b24dead4c">parameter :: size_tree</a> = 10000, &amp;
<a name="l00015"></a>00015 !                        <a class="code" href="namespacetreevars.html#88ddb99cee17ffd203ed6e3adbdebaa5">maxaddress</a>=32768, &amp;
<a name="l00016"></a>00016 !                        <a class="code" href="namespacetreevars.html#9e75bc118eec193572c6977e290cc74e">nppm</a>=2000, &amp;
<a name="l00017"></a>00017 !                        <a class="code" href="namespacetreevars.html#2ab032311413ab109ee55aa6ee9a83ab">nbranch_max</a>=<a class="code" href="namespacetreevars.html#9d9579ed68e8c2570f66523b24dead4c">size_tree</a>/10
<a name="l00018"></a>00018 
<a name="l00019"></a>00019  ! Constants
<a name="l00020"></a>00020 
<a name="l00021"></a><a class="code" href="namespacetreevars.html#e81ec702e5854eb659b60ed694d2f732">00021</a>   integer, dimension(0:7) :: <a class="code" href="namespacetreevars.html#e81ec702e5854eb659b60ed694d2f732">bitarr</a> = (/ 0,1,2,3,4,5,6,7 /)    ! Array of bit positions
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 !  Associated MPI stuff
<a name="l00024"></a>00024 
<a name="l00025"></a><a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">00025</a>   integer :: <a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>       ! Rank of current task
<a name="l00026"></a><a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">00026</a>   integer :: <a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a>   ! # cpus used by program
<a name="l00027"></a>00027 
<a name="l00028"></a>00028  ! Hash table datatype - 36 bytes per entry
<a name="l00029"></a>00029  
<a name="l00030"></a><a class="code" href="structtreevars_1_1hash.html">00030</a>   type <a class="code" href="structtreevars_1_1hash.html">hash</a>
<a name="l00031"></a><a class="code" href="structtreevars_1_1hash.html#5c752a676a6b22977126a5b6636c9e8b">00031</a>      integer   :: node          ! Address of <a class="code" href="structtreevars_1_1particle.html">particle</a>/pseudoparticle data
<a name="l00032"></a><a class="code" href="structtreevars_1_1hash.html#b1591cae25e0322448e824fe03a6a14a">00032</a>      integer*8 :: key           ! Key
<a name="l00033"></a><a class="code" href="structtreevars_1_1hash.html#a63999aab17d1bd63f24d6ab3413275f">00033</a>      integer   :: link          ! Pointer to next empty <a class="code" href="namespacetreevars.html#3ecc2e98e400f5751ae1758d72035e15">address</a> in table in case of collision
<a name="l00034"></a><a class="code" href="structtreevars_1_1hash.html#0612c75d950aaa369bf583d98ac48757">00034</a>      integer   :: leaves        ! # leaves contained within twig (=1 for leaf, <a class="code" href="namespacetreevars.html#ac21a2dc42e5595e66cba603534873bd">npart</a> for root)
<a name="l00035"></a><a class="code" href="structtreevars_1_1hash.html#6fcfa2980002607ea07091e04dea73ad">00035</a>      integer   :: childcode     ! Byte code indicating position of children (twig node); <a class="code" href="structtreevars_1_1particle.html">particle</a> label (leaf node)
<a name="l00036"></a><a class="code" href="structtreevars_1_1hash.html#afd4434daf444f3c49ac7d1ef3fd9fb6">00036</a>      integer*8 :: next          ! Pointer to next key to examine in tree-walk
<a name="l00037"></a><a class="code" href="structtreevars_1_1hash.html#829b4f3fbd5e32c9a45fa811e8e8a4bd">00037</a>      integer   :: owner         ! Node owner (for branches)
<a name="l00038"></a>00038   end type <a class="code" href="structtreevars_1_1hash.html">hash</a>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040   !  <a class="code" href="structtreevars_1_1hash.html">hash</a> table
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="namespacetreevars.html#f3784041f7cce271ebb213e4e88fb0a0">00042</a>   type (<a class="code" href="structtreevars_1_1hash.html">hash</a>), allocatable :: <a class="code" href="namespacetreevars.html#f3784041f7cce271ebb213e4e88fb0a0">htable</a>(:)
<a name="l00043"></a>00043   
<a name="l00044"></a>00044   
<a name="l00045"></a>00045  ! Data structure for shipping single particles
<a name="l00046"></a>00046   
<a name="l00047"></a><a class="code" href="structtreevars_1_1particle.html">00047</a>   type <a class="code" href="structtreevars_1_1particle.html">particle</a>
<a name="l00048"></a><a class="code" href="structtreevars_1_1particle.html#01b0fcd4b037e7ab140f958fdc2a3484">00048</a>      real*8 :: <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>    ! coords
<a name="l00049"></a><a class="code" href="structtreevars_1_1particle.html#0e5b5b7e2ac0d3aedbe23e98f8fca433">00049</a>      real*8 :: <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>
<a name="l00050"></a><a class="code" href="structtreevars_1_1particle.html#811742c033acb095c180260063dd7443">00050</a>      real*8 :: <a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>
<a name="l00051"></a><a class="code" href="structtreevars_1_1particle.html#3269ad818ceea3519968f32c2e442e3d">00051</a>      real*8 :: <a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>    ! momenta
<a name="l00052"></a><a class="code" href="structtreevars_1_1particle.html#fc023b6108cd42a98df51f7b16a397f8">00052</a>      real*8 :: <a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>
<a name="l00053"></a><a class="code" href="structtreevars_1_1particle.html#66003896ae949348e51f54525c7799b9">00053</a>      real*8 :: <a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a> 
<a name="l00054"></a><a class="code" href="structtreevars_1_1particle.html#1aa7d26113a9cdf29ecfb0679b1750ae">00054</a>      real*8 :: <a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>     ! <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a>
<a name="l00055"></a><a class="code" href="structtreevars_1_1particle.html#667fb31755d77cbe2e3c8d4628827b83">00055</a>      real*8 :: <a class="code" href="namespacetreevars.html#6c12d2901c45a88c6f838e61074b3577">m</a>     ! mass
<a name="l00056"></a><a class="code" href="structtreevars_1_1particle.html#342daf77ff7e48d689859619dd4ed424">00056</a>      real*8 :: <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a>  ! <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a> load from force sum
<a name="l00057"></a><a class="code" href="structtreevars_1_1particle.html#bb324b0a6577cd7a3838662e5ce98921">00057</a>      real*8 :: ax   ! 'forces' 
<a name="l00058"></a><a class="code" href="structtreevars_1_1particle.html#a3e4b49ed8eda59e95703a4aa6d9aa10">00058</a>      real*8 :: ay
<a name="l00059"></a><a class="code" href="structtreevars_1_1particle.html#edbe4cfb44fd760a13e08a6a0356037a">00059</a>      real*8 :: az
<a name="l00060"></a><a class="code" href="structtreevars_1_1particle.html#b1591cae25e0322448e824fe03a6a14a">00060</a>      integer*8 :: key           ! Key
<a name="l00061"></a><a class="code" href="structtreevars_1_1particle.html#041d80eed7d9f64fb5308e126e3fbd89">00061</a>      integer :: label    ! label
<a name="l00062"></a><a class="code" href="structtreevars_1_1particle.html#9200d8e4fe6a66f995279b824e81ecca">00062</a>      integer :: pid      ! owner
<a name="l00063"></a>00063   end type <a class="code" href="structtreevars_1_1particle.html">particle</a>
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="namespacetreevars.html#91492fbd344715a6805b92048a06b0ad">00065</a>   type (<a class="code" href="structtreevars_1_1particle.html">particle</a>) :: <a class="code" href="namespacetreevars.html#91492fbd344715a6805b92048a06b0ad">ship_props</a>, <a class="code" href="namespacetreevars.html#656cfc72705848b706282b137ed649a0">get_props</a>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a>00069  ! Data structure for shipping multiple moments of child nodes
<a name="l00070"></a>00070   
<a name="l00071"></a><a class="code" href="structtreevars_1_1multipole.html">00071</a>   type <a class="code" href="structtreevars_1_1multipole.html">multipole</a>
<a name="l00072"></a><a class="code" href="structtreevars_1_1multipole.html#b1591cae25e0322448e824fe03a6a14a">00072</a>      integer*8 :: key     ! key
<a name="l00073"></a><a class="code" href="structtreevars_1_1multipole.html#d430e142c79db63cf1b7397603801d56">00073</a>      integer   :: byte    ! byte code
<a name="l00074"></a><a class="code" href="structtreevars_1_1multipole.html#0612c75d950aaa369bf583d98ac48757">00074</a>      integer   :: leaves  ! <span class="preprocessor"># leaves contained</span>
<a name="l00075"></a><a class="code" href="structtreevars_1_1multipole.html#829b4f3fbd5e32c9a45fa811e8e8a4bd">00075</a> <span class="preprocessor"></span>     integer :: owner    ! owner where <a class="code" href="structtreevars_1_1multipole.html">multipole</a> resides
<a name="l00076"></a><a class="code" href="structtreevars_1_1multipole.html#afd4434daf444f3c49ac7d1ef3fd9fb6">00076</a>      integer*8 :: next    ! next key on walk
<a name="l00077"></a><a class="code" href="structtreevars_1_1multipole.html#1aa7d26113a9cdf29ecfb0679b1750ae">00077</a>      real*8<a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f"> :: q</a>        ! net <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a> sum
<a name="l00078"></a><a class="code" href="structtreevars_1_1multipole.html#fca003c02fd085b4455a6c2d873195b8">00078</a>      real*8 :: absq     !  absolute <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a> sum
<a name="l00079"></a><a class="code" href="structtreevars_1_1multipole.html#532f88a5ecddbae883afd55aa994d82d">00079</a>      real*8<a class="code" href="namespacetreevars.html#4d053c9047892373590cadde565e3987"> :: xcoc</a>     ! centre of <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a>
<a name="l00080"></a><a class="code" href="structtreevars_1_1multipole.html#5f5b043ceca46f3650e4f32b1ba53cb2">00080</a>      real*8<a class="code" href="namespacetreevars.html#12a758eeb25f419290c25611e464f6d5"> :: ycoc</a>    
<a name="l00081"></a><a class="code" href="structtreevars_1_1multipole.html#9f48052a0ccc645cc3fab0d613b392e5">00081</a>      real*8<a class="code" href="namespacetreevars.html#670ff1fa3088f3e7884811892883a9aa"> :: zcoc</a>
<a name="l00082"></a><a class="code" href="structtreevars_1_1multipole.html#aa91af38b12f1073e0833c53c5ac6137">00082</a>      real*8<a class="code" href="namespacetreevars.html#3dd15b2d32e2287f4cb38816e1aaec30"> :: xdip</a>     ! dipole moment
<a name="l00083"></a><a class="code" href="structtreevars_1_1multipole.html#1199beaafa5a127d9d52ee5c36492cf2">00083</a>      real*8<a class="code" href="namespacetreevars.html#20ca9029cf1ae376692b319a202ec4a7"> :: ydip</a>
<a name="l00084"></a><a class="code" href="structtreevars_1_1multipole.html#95e26e8eeeec0b0d23c532cab49bf0c5">00084</a>      real*8<a class="code" href="namespacetreevars.html#60326fe33c337b0da29aa828d6da9dae"> :: zdip</a>
<a name="l00085"></a><a class="code" href="structtreevars_1_1multipole.html#556a064ff29bdd218b437f24bb482096">00085</a>      real*8<a class="code" href="namespacetreevars.html#fd025a204b3181aebd5d1833a115c037"> :: xxquad</a>   ! quadrupole moment
<a name="l00086"></a><a class="code" href="structtreevars_1_1multipole.html#473d2e94ca7a254d8ce6b336996014b9">00086</a>      real*8<a class="code" href="namespacetreevars.html#bfa839ef19e3616ca2e8aa110192d3e2"> :: yyquad</a>  
<a name="l00087"></a><a class="code" href="structtreevars_1_1multipole.html#9fbbcac2d2fe90b106c0f57c2d0a8e29">00087</a>      real*8<a class="code" href="namespacetreevars.html#1d3755f0ab2dca3b2f14d23c0c064dc2"> :: zzquad</a>
<a name="l00088"></a><a class="code" href="structtreevars_1_1multipole.html#3460f13110983f7d093ef6e93a374c6e">00088</a>      real*8<a class="code" href="namespacetreevars.html#bb2261d5c9c8a1c62ad5a8ff6c4b1e0b"> :: xyquad</a>
<a name="l00089"></a><a class="code" href="structtreevars_1_1multipole.html#38050b1d7248cac4376bd048b4a936e7">00089</a>      real*8<a class="code" href="namespacetreevars.html#7b35d76a055c6765224fd8776d87bff8"> :: yzquad</a>
<a name="l00090"></a><a class="code" href="structtreevars_1_1multipole.html#4a31bca4cb9cb20a3aef1034d9b387ad">00090</a>      real*8<a class="code" href="namespacetreevars.html#208c8681eab779b3d1b7105d4c7dab4a"> :: zxquad</a>
<a name="l00091"></a><a class="code" href="structtreevars_1_1multipole.html#9d17cc08f545a4957e0f807624add573">00091</a>      real*8<a class="code" href="namespacetreevars.html#a638e02fa2630a6f9ee865fdcf1b733b"> :: jx</a>        ! current
<a name="l00092"></a><a class="code" href="structtreevars_1_1multipole.html#0b3fe094d4f80c8147cf282514295e19">00092</a>      real*8<a class="code" href="namespacetreevars.html#95a1f21026d31cde85296c2d91e18b70"> :: jy</a>
<a name="l00093"></a><a class="code" href="structtreevars_1_1multipole.html#24178823751a5f08bcf06ffa13de972f">00093</a>      real*8<a class="code" href="namespacetreevars.html#e2ea5dfe327e1571ddbd3bc9e2d4b79d"> :: jz</a>
<a name="l00094"></a><a class="code" href="structtreevars_1_1multipole.html#793a83f40ea8e188cf12e594492ea013">00094</a>      real*8<a class="code" href="namespacetreevars.html#79cc90053d5078b57074a25ff5889b4c"> :: magmx</a>      ! magnetic moment
<a name="l00095"></a><a class="code" href="structtreevars_1_1multipole.html#e8fc075ce67bf90eb41e3fcb6846d6b2">00095</a>      real*8<a class="code" href="namespacetreevars.html#c5f25ca5b0581069057e0ac7b5d90939"> :: magmy</a>
<a name="l00096"></a><a class="code" href="structtreevars_1_1multipole.html#c99b23f709279f623b0a12455e5124a7">00096</a>      real*8<a class="code" href="namespacetreevars.html#0ffed3c46e462545a7b60d8478dc0bcc"> :: magmz</a>
<a name="l00097"></a>00097   end type <a class="code" href="structtreevars_1_1multipole.html">multipole</a>
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="namespacetreevars.html#579c49c8e8bc7fd7f0f16ca93fb8151c">00099</a>   type (<a class="code" href="structtreevars_1_1multipole.html">multipole</a>), <a class="code" href="namespacetreevars.html#579c49c8e8bc7fd7f0f16ca93fb8151c">allocatable :: pack_child</a>(:), <a class="code" href="namespacetreevars.html#d902932e8c109d33bc5a679c106302c2">get_child</a>(:)
<a name="l00100"></a><a class="code" href="namespacetreevars.html#985f54f128298f3378e88fc6479f5023">00100</a>   type (<a class="code" href="structtreevars_1_1multipole.html">multipole</a>) :: <a class="code" href="namespacetreevars.html#985f54f128298f3378e88fc6479f5023">node_dummy</a>
<a name="l00101"></a>00101 
<a name="l00102"></a><a class="code" href="namespacetreevars.html#57810588326e6323b6b7a9919ed4361f">00102</a>   integer, parameter :: <a class="code" href="namespacetreevars.html#57810588326e6323b6b7a9919ed4361f">nprops_particle</a>=15, &amp;    ! <span class="preprocessor"># particle properties to ship</span>
<a name="l00103"></a><a class="code" href="namespacetreevars.html#47d7691ec71220dd3a8ec31067981eb4">00103</a> <span class="preprocessor"></span>                        <a class="code" href="namespacetreevars.html#47d7691ec71220dd3a8ec31067981eb4">nprops_multipole</a>=25      ! Number of <a class="code" href="structtreevars_1_1multipole.html">multipole</a> properties to ship
<a name="l00104"></a><a class="code" href="namespacetreevars.html#13f7839c15303c661d07ef8fc6cb0c8a">00104</a>   integer, dimension(<a class="code" href="namespacetreevars.html#47d7691ec71220dd3a8ec31067981eb4">nprops_multipole</a>) :: <a class="code" href="namespacetreevars.html#8f2bb64bb5cb4a61e642008e575a15b6">blocklengths</a>, <a class="code" href="namespacetreevars.html#67a55b58ffaeb5bcf8fc77edea112021">displacements</a>, <a class="code" href="namespacetreevars.html#13f7839c15303c661d07ef8fc6cb0c8a">types</a>, <a class="code" href="namespacetreevars.html#3ecc2e98e400f5751ae1758d72035e15">address</a>
<a name="l00105"></a><a class="code" href="namespacetreevars.html#459f018657bf28c6bc2f5f5d8cc6a80d">00105</a>   integer :: <a class="code" href="namespacetreevars.html#459f018657bf28c6bc2f5f5d8cc6a80d">send_base</a>, <a class="code" href="namespacetreevars.html#9c3e8fe5004b39906270b537b9a72046">receive_base</a>, <a class="code" href="namespacetreevars.html#036dcc5d5f84ea66e74c53d6e2977d46">mpi_type_particle</a>, <a class="code" href="namespacetreevars.html#61bca8df8ac911795d9c6c821699e4f6">mpi_type_multipole</a>
<a name="l00106"></a>00106   
<a name="l00107"></a>00107 
<a name="l00108"></a>00108   !  tree variables
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   integer*8, allocatable :: &amp;
<a name="l00111"></a><a class="code" href="namespacetreevars.html#39c17ce55445417f27b9051800fca4cc">00111</a>                                 <a class="code" href="namespacetreevars.html#39c17ce55445417f27b9051800fca4cc">requested_keys</a>(:), &amp;  ! Remote nodes requested during tree walk/<a class="code" href="namespacetreevars.html#268e054a2a11dd7806061233237fef15">prefetch</a>
<a name="l00112"></a><a class="code" href="namespacetreevars.html#a22ead23f67e91c820b7e2388aa009eb">00112</a>                                 <a class="code" href="namespacetreevars.html#a22ead23f67e91c820b7e2388aa009eb">fetched_keys</a>(:), &amp;  ! Remote nodes fetched during tree walk/<a class="code" href="namespacetreevars.html#268e054a2a11dd7806061233237fef15">prefetch</a>
<a name="l00113"></a><a class="code" href="namespacetreevars.html#bfc0b2d44f95a2cfc7ac172c49fcc100">00113</a>                                 <a class="code" href="namespacetreevars.html#bfc0b2d44f95a2cfc7ac172c49fcc100">treekey</a>(:), &amp;       ! keys of all twig and leaf nodes
<a name="l00114"></a><a class="code" href="namespacetreevars.html#6b92639d5afb11b693bf39ddade2db42">00114</a>                                 <a class="code" href="namespacetreevars.html#6b92639d5afb11b693bf39ddade2db42">branch_key</a>(:), &amp;    ! keys of branch nodes covering all domains
<a name="l00115"></a><a class="code" href="namespacetreevars.html#0112df982c91b0e7167322015ffdc346">00115</a>                                 <a class="code" href="namespacetreevars.html#0112df982c91b0e7167322015ffdc346">pebranch</a>(:), &amp;      ! keys of branch nodes covering local domain
<a name="l00116"></a><a class="code" href="namespacetreevars.html#83e2deb11bf06d2ceee1d35e84b7c5f1">00116</a>                                 <a class="code" href="namespacetreevars.html#83e2deb11bf06d2ceee1d35e84b7c5f1">leaf_key</a>(:), &amp;      ! local leaf keys
<a name="l00117"></a><a class="code" href="namespacetreevars.html#48335e63d98923c0c5d0722b98a29813">00117</a>                                 <a class="code" href="namespacetreevars.html#48335e63d98923c0c5d0722b98a29813">twig_key</a>(:)         ! local twig keys
<a name="l00118"></a>00118 
<a name="l00119"></a>00119   integer, allocatable :: &amp;
<a name="l00120"></a><a class="code" href="namespacetreevars.html#3570b96c236051793cf00a6eadcf9bd5">00120</a>                                 <a class="code" href="namespacetreevars.html#3570b96c236051793cf00a6eadcf9bd5">nbranches</a>(:), &amp;       ! # branches in local domain
<a name="l00121"></a><a class="code" href="namespacetreevars.html#847ffa5de28ba3168e2b3d4fc6b70d4c">00121</a>                                 <a class="code" href="namespacetreevars.html#847ffa5de28ba3168e2b3d4fc6b70d4c">igap</a>(:), &amp;    !  stride lengths of local branch arrays
<a name="l00122"></a><a class="code" href="namespacetreevars.html#182bead284ef129cafb92110859b64d0">00122</a>                                 <a class="code" href="namespacetreevars.html#182bead284ef129cafb92110859b64d0">branch_owner</a>(:), &amp;    ! owners of branch nodes covering all domains
<a name="l00123"></a><a class="code" href="namespacetreevars.html#f84258c0a4cd172530a87be119c6e088">00123</a>                                 <a class="code" href="namespacetreevars.html#f84258c0a4cd172530a87be119c6e088">all_addr</a>(:), &amp;  ! List of all possible #table addresses
<a name="l00124"></a><a class="code" href="namespacetreevars.html#62139dfb2051a09a9555ab662366ab0f">00124</a>                                 <a class="code" href="namespacetreevars.html#62139dfb2051a09a9555ab662366ab0f">free_addr</a>(:), &amp;    ! List of free #table addresses (for HASHENTRY routine)
<a name="l00125"></a><a class="code" href="namespacetreevars.html#92331c0f615bfbb97593f8866d407cbb">00125</a>                                 <a class="code" href="namespacetreevars.html#92331c0f615bfbb97593f8866d407cbb">point_free</a>(:), &amp;   ! Pointer to free <a class="code" href="namespacetreevars.html#3ecc2e98e400f5751ae1758d72035e15">address</a> index
<a name="l00126"></a><a class="code" href="namespacetreevars.html#b09589862184928a4ee266fea3822c47">00126</a>                                 <a class="code" href="namespacetreevars.html#b09589862184928a4ee266fea3822c47">fetched_owner</a>(:), &amp; ! Owners of nonlocal keys fetched
<a name="l00127"></a><a class="code" href="namespacetreevars.html#e05d1a9d4583e84923db6cff4aa9cb4e">00127</a>                                 <a class="code" href="namespacetreevars.html#e05d1a9d4583e84923db6cff4aa9cb4e">requested_owner</a>(:), &amp; ! Recipients of <a class="code" href="structtreevars_1_1multipole.html">multipole</a> ships 
<a name="l00128"></a><a class="code" href="namespacetreevars.html#c56353fcc7cc41b4f1f42d0a50cc4d64">00128</a>                                 <a class="code" href="namespacetreevars.html#c56353fcc7cc41b4f1f42d0a50cc4d64">nreqs_total</a>(:), &amp;    ! total # nodes requested from local PE during tree walk
<a name="l00129"></a><a class="code" href="namespacetreevars.html#57da86873a8ef7e030a571b7ad0263f0">00129</a>                                 <a class="code" href="namespacetreevars.html#57da86873a8ef7e030a571b7ad0263f0">nfetch_total</a>(:)   ! total # non-local nodes fetched during tree walk 
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   real*8, allocatable  :: &amp;                ! Tree node properties:
<a name="l00132"></a><a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">00132</a>                                <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a>(:), &amp;                          ! <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a>
<a name="l00133"></a><a class="code" href="namespacetreevars.html#833874545f1ee36b5e31b4dfa3dc11d3">00133</a>                                <a class="code" href="namespacetreevars.html#833874545f1ee36b5e31b4dfa3dc11d3">abs_charge</a>(:), &amp;                      ! absolute <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a>
<a name="l00134"></a><a class="code" href="namespacetreevars.html#670ff1fa3088f3e7884811892883a9aa">00134</a>                                <a class="code" href="namespacetreevars.html#4d053c9047892373590cadde565e3987">xcoc</a>(:), <a class="code" href="namespacetreevars.html#12a758eeb25f419290c25611e464f6d5">ycoc</a>(:), <a class="code" href="namespacetreevars.html#670ff1fa3088f3e7884811892883a9aa">zcoc</a>(:), &amp;          ! centre of <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a> 
<a name="l00135"></a><a class="code" href="namespacetreevars.html#d302471357d728d005b3ffdeda5ec4f8">00135</a>                                <a class="code" href="namespacetreevars.html#45818496b7960c015016dba950a2b593">xshift</a>(:), <a class="code" href="namespacetreevars.html#768042e13663b004bb82cdb6ead3ca22">yshift</a>(:), <a class="code" href="namespacetreevars.html#d302471357d728d005b3ffdeda5ec4f8">zshift</a>(:), &amp;    ! shift vector
<a name="l00136"></a><a class="code" href="namespacetreevars.html#60326fe33c337b0da29aa828d6da9dae">00136</a>                                <a class="code" href="namespacetreevars.html#3dd15b2d32e2287f4cb38816e1aaec30">xdip</a>(:), <a class="code" href="namespacetreevars.html#20ca9029cf1ae376692b319a202ec4a7">ydip</a>(:), <a class="code" href="namespacetreevars.html#60326fe33c337b0da29aa828d6da9dae">zdip</a>(:), &amp;          ! dipole moment
<a name="l00137"></a><a class="code" href="namespacetreevars.html#1d3755f0ab2dca3b2f14d23c0c064dc2">00137</a>                                <a class="code" href="namespacetreevars.html#fd025a204b3181aebd5d1833a115c037">xxquad</a>(:), <a class="code" href="namespacetreevars.html#bfa839ef19e3616ca2e8aa110192d3e2">yyquad</a>(:), <a class="code" href="namespacetreevars.html#1d3755f0ab2dca3b2f14d23c0c064dc2">zzquad</a>(:), &amp;    ! quadrupole moment
<a name="l00138"></a><a class="code" href="namespacetreevars.html#208c8681eab779b3d1b7105d4c7dab4a">00138</a>                                <a class="code" href="namespacetreevars.html#bb2261d5c9c8a1c62ad5a8ff6c4b1e0b">xyquad</a>(:), <a class="code" href="namespacetreevars.html#7b35d76a055c6765224fd8776d87bff8">yzquad</a>(:), <a class="code" href="namespacetreevars.html#208c8681eab779b3d1b7105d4c7dab4a">zxquad</a>(:), &amp;    !
<a name="l00139"></a><a class="code" href="namespacetreevars.html#0ffed3c46e462545a7b60d8478dc0bcc">00139</a>                                <a class="code" href="namespacetreevars.html#79cc90053d5078b57074a25ff5889b4c">magmx</a>(:), <a class="code" href="namespacetreevars.html#c5f25ca5b0581069057e0ac7b5d90939">magmy</a>(:), <a class="code" href="namespacetreevars.html#0ffed3c46e462545a7b60d8478dc0bcc">magmz</a>(:), &amp;       ! magnetic dipole moment
<a name="l00140"></a><a class="code" href="namespacetreevars.html#e2ea5dfe327e1571ddbd3bc9e2d4b79d">00140</a>                                <a class="code" href="namespacetreevars.html#a638e02fa2630a6f9ee865fdcf1b733b">jx</a>(:), <a class="code" href="namespacetreevars.html#95a1f21026d31cde85296c2d91e18b70">jy</a>(:), <a class="code" href="namespacetreevars.html#e2ea5dfe327e1571ddbd3bc9e2d4b79d">jz</a>(:)                   ! current
<a name="l00141"></a><a class="code" href="namespacetreevars.html#368a06dc09d689328cc73ddf69490a3f">00141</a>   integer*8, allocatable ::    <a class="code" href="namespacetreevars.html#368a06dc09d689328cc73ddf69490a3f">first_child</a>(:)   ! key of first child
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="namespacetreevars.html#273d43aa2e27f0f2d74fa02458d54d2d">00143</a>   integer, allocatable ::       <a class="code" href="namespacetreevars.html#273d43aa2e27f0f2d74fa02458d54d2d">n_children</a>(:), &amp;     ! # children
<a name="l00144"></a><a class="code" href="namespacetreevars.html#4806e1728d085ba63091689ed4e089a2">00144</a>                                 <a class="code" href="namespacetreevars.html#4806e1728d085ba63091689ed4e089a2">node_level</a>(:)       ! refinement level
<a name="l00145"></a>00145  
<a name="l00146"></a>00146 
<a name="l00147"></a><a class="code" href="namespacetreevars.html#6ef75ad7136a3e44f982b5bc54fe73ee">00147</a>   integer*8 ::  <a class="code" href="namespacetreevars.html#6ef75ad7136a3e44f982b5bc54fe73ee">hashconst</a>, &amp;   ! hashing constants
<a name="l00148"></a><a class="code" href="namespacetreevars.html#a3ccc4bce493257f711cee0d5bfa95ef">00148</a>                 <a class="code" href="namespacetreevars.html#a3ccc4bce493257f711cee0d5bfa95ef">hashchild</a>=7_8, &amp;
<a name="l00149"></a><a class="code" href="namespacetreevars.html#dc35764a2ebcba3e60d5cefa52bf1104">00149</a>                 <a class="code" href="namespacetreevars.html#dc35764a2ebcba3e60d5cefa52bf1104">iplace</a>         ! value of place holder bit = 2^(2*<a class="code" href="namespacetreevars.html#5f5b3f17c0444f500a18ba56caa6fa48">nlev</a>)
<a name="l00150"></a>00150 
<a name="l00151"></a>00151   integer :: &amp;
<a name="l00152"></a><a class="code" href="namespacetreevars.html#5f5b3f17c0444f500a18ba56caa6fa48">00152</a>              <a class="code" href="namespacetreevars.html#5f5b3f17c0444f500a18ba56caa6fa48">nlev</a>, &amp;           ! max refinement level
<a name="l00153"></a><a class="code" href="namespacetreevars.html#c6a9ed36599e598d11b2f64b1c7fb2a0">00153</a>              <a class="code" href="namespacetreevars.html#c6a9ed36599e598d11b2f64b1c7fb2a0">nbaddr</a>, &amp;         ! # bits in hashing function
<a name="l00154"></a><a class="code" href="namespacetreevars.html#fb6610fee5c52c51b8f7cc46ce975c16">00154</a>              <a class="code" href="namespacetreevars.html#fb6610fee5c52c51b8f7cc46ce975c16">nleaf</a>, &amp;          ! total # leaf nodes in local #table 
<a name="l00155"></a><a class="code" href="namespacetreevars.html#863a5294e9f064d8de564660bd1cf82d">00155</a>              <a class="code" href="namespacetreevars.html#863a5294e9f064d8de564660bd1cf82d">ntwig</a>, &amp;          ! total # twig nodes in local #table
<a name="l00156"></a><a class="code" href="namespacetreevars.html#9d0ea8878e6790262000ba4d92324583">00156</a>              <a class="code" href="namespacetreevars.html#9d0ea8878e6790262000ba4d92324583">nleaf_me</a>, &amp;       ! total # leaves in local domain
<a name="l00157"></a><a class="code" href="namespacetreevars.html#7e3153d8a8b22c2802f4b3c054e10fd2">00157</a>              <a class="code" href="namespacetreevars.html#7e3153d8a8b22c2802f4b3c054e10fd2">ntwig_me</a>, &amp;       ! total # twigs in local domain
<a name="l00158"></a><a class="code" href="namespacetreevars.html#0ab6b4bd7d72fb33ff1080972a6000ef">00158</a>              <a class="code" href="namespacetreevars.html#0ab6b4bd7d72fb33ff1080972a6000ef">nlist</a>, &amp;          ! # particles/PE + boundary bodies (1 or 2)
<a name="l00159"></a><a class="code" href="namespacetreevars.html#a1eb75b89eb026fdd25ce002fc580fc9">00159</a>              <a class="code" href="namespacetreevars.html#a1eb75b89eb026fdd25ce002fc580fc9">nnodes</a>, &amp;         ! <a class="code" href="namespacetreevars.html#fb6610fee5c52c51b8f7cc46ce975c16">nleaf</a> + <a class="code" href="namespacetreevars.html#863a5294e9f064d8de564660bd1cf82d">ntwig</a>
<a name="l00160"></a><a class="code" href="namespacetreevars.html#dac0b938bdc98e47c35adf931cf107ba">00160</a>              <a class="code" href="namespacetreevars.html#dac0b938bdc98e47c35adf931cf107ba">nnodes_me</a>, &amp;      ! <a class="code" href="namespacetreevars.html#9d0ea8878e6790262000ba4d92324583">nleaf_me</a> + <a class="code" href="namespacetreevars.html#7e3153d8a8b22c2802f4b3c054e10fd2">ntwig_me</a>
<a name="l00161"></a><a class="code" href="namespacetreevars.html#f4e6903e8f5e2f99688d7c45256c012a">00161</a>              <a class="code" href="namespacetreevars.html#f4e6903e8f5e2f99688d7c45256c012a">nnodes_pw</a>, &amp;      ! # <a class="code" href="namespacetreevars.html#a1eb75b89eb026fdd25ce002fc580fc9">nnodes</a> prior to tree-walk
<a name="l00162"></a><a class="code" href="namespacetreevars.html#fbfbca89466cde5cbb0ea05f5bdda449">00162</a>              <a class="code" href="namespacetreevars.html#fbfbca89466cde5cbb0ea05f5bdda449">nleaf_pw</a>, &amp;       ! # leaves prior to walk
<a name="l00163"></a><a class="code" href="namespacetreevars.html#62eac775dcb0b46af78b95fc81d4c8d4">00163</a>              <a class="code" href="namespacetreevars.html#62eac775dcb0b46af78b95fc81d4c8d4">ntwig_pw</a>, &amp;       ! # twigs prior to walk
<a name="l00164"></a><a class="code" href="namespacetreevars.html#1f1e66a4a2d8a1c31ce68e97ff49b7db">00164</a>              <a class="code" href="namespacetreevars.html#1f1e66a4a2d8a1c31ce68e97ff49b7db">nbranch</a>, &amp;        ! min # branch nodes covering local domain
<a name="l00165"></a><a class="code" href="namespacetreevars.html#47708bdfab837f3fc4ea54b8c8f99a50">00165</a>              <a class="code" href="namespacetreevars.html#47708bdfab837f3fc4ea54b8c8f99a50">nbranch_sum</a>, &amp;    ! total # branch nodes covering all domains
<a name="l00166"></a><a class="code" href="namespacetreevars.html#4f04c8bb799d1a68b883e63b3746012d">00166</a>              <a class="code" href="namespacetreevars.html#4f04c8bb799d1a68b883e63b3746012d">nintmax</a>, &amp;        ! max # terms allowed in interaction list
<a name="l00167"></a><a class="code" href="namespacetreevars.html#eedff4d85b564024fa75dda1a3aceb78">00167</a>              <a class="code" href="namespacetreevars.html#eedff4d85b564024fa75dda1a3aceb78">max_list_length</a>, &amp; ! current max list length
<a name="l00168"></a><a class="code" href="namespacetreevars.html#88ddb99cee17ffd203ed6e3adbdebaa5">00168</a>              <a class="code" href="namespacetreevars.html#88ddb99cee17ffd203ed6e3adbdebaa5">maxaddress</a>, &amp;     ! max <a class="code" href="namespacetreevars.html#3ecc2e98e400f5751ae1758d72035e15">address</a> allowed in #table
<a name="l00169"></a><a class="code" href="namespacetreevars.html#ae25455b851f03005b9ff34a1c03c139">00169</a>              <a class="code" href="namespacetreevars.html#ae25455b851f03005b9ff34a1c03c139">maxleaf</a>, &amp;     ! max leaf allowed in #table
<a name="l00170"></a><a class="code" href="namespacetreevars.html#adabb762937263c1bae53f9c21fd662e">00170</a>              <a class="code" href="namespacetreevars.html#adabb762937263c1bae53f9c21fd662e">maxtwig</a>, &amp;     ! max twig allowed in #table
<a name="l00171"></a><a class="code" href="namespacetreevars.html#9d9579ed68e8c2570f66523b24dead4c">00171</a>              <a class="code" href="namespacetreevars.html#9d9579ed68e8c2570f66523b24dead4c">size_tree</a>, &amp;      ! array space needed for local tree
<a name="l00172"></a><a class="code" href="namespacetreevars.html#e34bba8fd21d4150370b72505a8b8ab7">00172</a>              <a class="code" href="namespacetreevars.html#e34bba8fd21d4150370b72505a8b8ab7">size_fetch</a>, &amp;      ! array space needed for fetch/request arrays 
<a name="l00173"></a><a class="code" href="namespacetreevars.html#66a1faa6be6c372bb5a156d17381b892">00173</a>              <a class="code" href="namespacetreevars.html#66a1faa6be6c372bb5a156d17381b892">maxtraverse</a>, &amp;      ! max # traversals per iteration 
<a name="l00174"></a><a class="code" href="namespacetreevars.html#4d5bca610c11d77ef6fe35a886088328">00174</a>              <a class="code" href="namespacetreevars.html#4d5bca610c11d77ef6fe35a886088328">maxships</a>, &amp;       ! max # <a class="code" href="structtreevars_1_1multipole.html">multipole</a> ships per traversal 
<a name="l00175"></a><a class="code" href="namespacetreevars.html#98a5e67d24ae4f0fe88492d6cf4f77a9">00175</a>              <a class="code" href="namespacetreevars.html#98a5e67d24ae4f0fe88492d6cf4f77a9">sum_ships</a>, &amp;      ! total # <a class="code" href="structtreevars_1_1multipole.html">multipole</a> ships per iteration  
<a name="l00176"></a><a class="code" href="namespacetreevars.html#959a7ea5cb1126405dfbdbccfe52579c">00176</a>              <a class="code" href="namespacetreevars.html#959a7ea5cb1126405dfbdbccfe52579c">sum_fetches</a>, &amp;    ! total # key fetches  per iteration  
<a name="l00177"></a><a class="code" href="namespacetreevars.html#452b042822b98ddede3a99dac2db3ef1">00177</a>              <a class="code" href="namespacetreevars.html#452b042822b98ddede3a99dac2db3ef1">max_prefetches</a>, &amp;      ! total # <a class="code" href="structtreevars_1_1multipole.html">multipole</a> ships per <a class="code" href="namespacetreevars.html#268e054a2a11dd7806061233237fef15">prefetch</a> 
<a name="l00178"></a><a class="code" href="namespacetreevars.html#2ab032311413ab109ee55aa6ee9a83ab">00178</a>              <a class="code" href="namespacetreevars.html#2ab032311413ab109ee55aa6ee9a83ab">nbranch_max</a>, &amp;    ! array space needed for branches
<a name="l00179"></a><a class="code" href="namespacetreevars.html#ec23f1879b3e629afb3c5fc2cfd98ddd">00179</a>              <a class="code" href="namespacetreevars.html#ec23f1879b3e629afb3c5fc2cfd98ddd">free_lo</a>, &amp;        ! min <a class="code" href="namespacetreevars.html#3ecc2e98e400f5751ae1758d72035e15">address</a> allowed for resolving collisions
<a name="l00180"></a><a class="code" href="namespacetreevars.html#695d45786e0ed5a22f2af74331b20fb0">00180</a>              <a class="code" href="namespacetreevars.html#695d45786e0ed5a22f2af74331b20fb0">tablehigh</a>, &amp;      ! highest current <a class="code" href="namespacetreevars.html#3ecc2e98e400f5751ae1758d72035e15">address</a> in #table 
<a name="l00181"></a><a class="code" href="namespacetreevars.html#d6c9044ddf9cc5989e35d17fed44a34c">00181</a>              <a class="code" href="namespacetreevars.html#d6c9044ddf9cc5989e35d17fed44a34c">sum_unused</a>, &amp;     ! # free addresses
<a name="l00182"></a><a class="code" href="namespacetreevars.html#0d5a9df9963aed1fb9d6ac000ba861f1">00182</a>              <a class="code" href="namespacetreevars.html#0d5a9df9963aed1fb9d6ac000ba861f1">ipefile</a>, &amp;             ! local O/P stream
<a name="l00183"></a><a class="code" href="namespacetreevars.html#0609b8334f1b6b75ff9586e4da39cf13">00183</a>              <a class="code" href="namespacetreevars.html#0609b8334f1b6b75ff9586e4da39cf13">pe_debug</a>, &amp;       ! rank for debug O/P
<a name="l00184"></a><a class="code" href="namespacetreevars.html#b615185d9b45bd2b9aca8d31685ce7df">00184</a>              <a class="code" href="namespacetreevars.html#b615185d9b45bd2b9aca8d31685ce7df">npartm</a>, &amp;         ! absolute max # particles
<a name="l00185"></a><a class="code" href="namespacetreevars.html#ac21a2dc42e5595e66cba603534873bd">00185</a>              <a class="code" href="namespacetreevars.html#ac21a2dc42e5595e66cba603534873bd">npart</a>, &amp;          ! actual # particles
<a name="l00186"></a><a class="code" href="namespacetreevars.html#9e75bc118eec193572c6977e290cc74e">00186</a>              <a class="code" href="namespacetreevars.html#9e75bc118eec193572c6977e290cc74e">nppm</a>, &amp;           ! max # particles/PE
<a name="l00187"></a><a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">00187</a>              <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>, &amp;            !  actual  # particles/PE
<a name="l00188"></a><a class="code" href="namespacetreevars.html#5ae03d212991a18d05e377ced298a766">00188</a>              <a class="code" href="namespacetreevars.html#5ae03d212991a18d05e377ced298a766">nshortm</a>, &amp;        ! shortlist length
<a name="l00189"></a><a class="code" href="namespacetreevars.html#f46f14fbb5af4c8f057fc02a656910c0">00189</a>              <a class="code" href="namespacetreevars.html#f46f14fbb5af4c8f057fc02a656910c0">iused</a>          ! counter for collision resolution array <a class="code" href="namespacetreevars.html#62139dfb2051a09a9555ab662366ab0f">free_addr</a>()
<a name="l00190"></a><a class="code" href="namespacetreevars.html#5254afbd41f37f9199feb0ef874da549">00190</a>   real :: <a class="code" href="namespacetreevars.html#5254afbd41f37f9199feb0ef874da549">work_imbal</a>=0.
<a name="l00191"></a><a class="code" href="namespacetreevars.html#1c6f6ce6c7237fbdefef8c4744d82536">00191</a>   real :: <a class="code" href="namespacetreevars.html#1c6f6ce6c7237fbdefef8c4744d82536">part_imbal</a>=0.
<a name="l00192"></a><a class="code" href="namespacetreevars.html#d77dd3f319d1220bdae713de6ee6e9a9">00192</a>   real :: <a class="code" href="namespacetreevars.html#5e9d6d6bc5fa5b4ba685e8d09ddfdb21">work_imbal_max</a>, <a class="code" href="namespacetreevars.html#d77dd3f319d1220bdae713de6ee6e9a9">work_imbal_min</a>  ! load stats
<a name="l00193"></a><a class="code" href="namespacetreevars.html#a5ac7398debd6e725cb5c598634c9847">00193</a>   integer ::  <a class="code" href="namespacetreevars.html#037f0ca40826a460afc88f31014fde6d">part_imbal_max</a>, <a class="code" href="namespacetreevars.html#a5ac7398debd6e725cb5c598634c9847">part_imbal_min</a>
<a name="l00194"></a><a class="code" href="namespacetreevars.html#6ccbebd32d635e79b3f80fff71840543">00194</a>   real :: <a class="code" href="namespacetreevars.html#6ccbebd32d635e79b3f80fff71840543">work_local</a> ! Total local <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a> load (=sum of interaction lists)
<a name="l00195"></a><a class="code" href="namespacetreevars.html#2ec63c3b9cf68233a13c938d6db6a02d">00195</a>   real*8 :: <a class="code" href="namespacetreevars.html#2ec63c3b9cf68233a13c938d6db6a02d">xmin</a>, <a class="code" href="namespacetreevars.html#a38e10142dd775dee00930af92583362">xmax</a>    ! box limits
<a name="l00196"></a><a class="code" href="namespacetreevars.html#341f905fe7f315fa0c25845356344e6a">00196</a>   real*8 :: <a class="code" href="namespacetreevars.html#341f905fe7f315fa0c25845356344e6a">ymin</a>, <a class="code" href="namespacetreevars.html#547c7725185c4acf1d9b1cc1e32db2d1">ymax</a>  
<a name="l00197"></a><a class="code" href="namespacetreevars.html#9c95b8df2b8d5e4e8131e52a3ee19647">00197</a>   real*8 :: <a class="code" href="namespacetreevars.html#9c95b8df2b8d5e4e8131e52a3ee19647">zmin</a>, <a class="code" href="namespacetreevars.html#094a88ceb292294fbb3df63db8ae77e9">zmax</a>
<a name="l00198"></a><a class="code" href="namespacetreevars.html#8b7d0bfaafb4911e08470411d32719f7">00198</a>   real*8 :: <a class="code" href="namespacetreevars.html#8b7d0bfaafb4911e08470411d32719f7">boxsize</a>       ! length of box
<a name="l00199"></a>00199 
<a name="l00200"></a>00200  ! Force control
<a name="l00201"></a><a class="code" href="namespacetreevars.html#a09bfc5f3d0322ca9ff874dea4ee4864">00201</a>   integer :: <a class="code" href="namespacetreevars.html#a09bfc5f3d0322ca9ff874dea4ee4864">load_balance</a>   ! Balances particles in || sort according to <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a> load
<a name="l00202"></a><a class="code" href="namespacetreevars.html#c750066ab547925fefe94d8d745d6c0d">00202</a>   logical :: <a class="code" href="namespacetreevars.html#c750066ab547925fefe94d8d745d6c0d">use_multipoles</a> = .true.   ! Use of multipoles? 
<a name="l00203"></a><a class="code" href="namespacetreevars.html#268e054a2a11dd7806061233237fef15">00203</a>   logical :: <a class="code" href="namespacetreevars.html#268e054a2a11dd7806061233237fef15">prefetch</a> = .false.  ! Prefetch <a class="code" href="structtreevars_1_1multipole.html">multipole</a> info prior to walk
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   ! Debugging switches (all off by default)
<a name="l00206"></a><a class="code" href="namespacetreevars.html#3db87213360b7b79fc7bc0b62c93ff30">00206</a>   logical :: <a class="code" href="namespacetreevars.html#3db87213360b7b79fc7bc0b62c93ff30">tree_debug</a>=.false.
<a name="l00207"></a><a class="code" href="namespacetreevars.html#af090ee31bd2f8257db663f92e09bce7">00207</a>   logical :: <a class="code" href="namespacetreevars.html#af090ee31bd2f8257db663f92e09bce7">build_debug</a>=.false.
<a name="l00208"></a><a class="code" href="namespacetreevars.html#49919cda29c851a7464ea9b3d37d7fce">00208</a>   logical :: <a class="code" href="namespacetreevars.html#49919cda29c851a7464ea9b3d37d7fce">domain_debug</a> = .false.
<a name="l00209"></a><a class="code" href="namespacetreevars.html#c3309cf4ec043d5956cd45aa550ad196">00209</a>   logical :: <a class="code" href="namespacetreevars.html#c3309cf4ec043d5956cd45aa550ad196">branch_debug</a>=.false.
<a name="l00210"></a><a class="code" href="namespacetreevars.html#951fff9f3a94d5095788ba2d42be9151">00210</a>   logical :: <a class="code" href="namespacetreevars.html#951fff9f3a94d5095788ba2d42be9151">prefetch_debug</a>=.false.
<a name="l00211"></a><a class="code" href="namespacetreevars.html#415096877a1abe9a37d0435e96d0f30a">00211</a>   logical :: <a class="code" href="namespacetreevars.html#415096877a1abe9a37d0435e96d0f30a">walk_debug</a>=.false.
<a name="l00212"></a><a class="code" href="namespacetreevars.html#af03d6c35b13db23cd43b4522df652a4">00212</a>   logical :: <a class="code" href="namespacetreevars.html#af03d6c35b13db23cd43b4522df652a4">walk_summary</a>=.false.
<a name="l00213"></a><a class="code" href="namespacetreevars.html#001505bba4c1517aa171fe7a61bc3c9c">00213</a>   logical :: <a class="code" href="namespacetreevars.html#001505bba4c1517aa171fe7a61bc3c9c">force_debug</a>=.false.
<a name="l00214"></a><a class="code" href="namespacetreevars.html#917587657ac434132020e7adaeb8b1f3">00214</a>   logical :: <a class="code" href="namespacetreevars.html#917587657ac434132020e7adaeb8b1f3">dump_tree</a>=.false.
<a name="l00215"></a><a class="code" href="namespacetreevars.html#2742062d663e59ef258b160b545dcffb">00215</a>   logical :: <a class="code" href="namespacetreevars.html#2742062d663e59ef258b160b545dcffb">perf_anal</a>=.false.  ! Performance analysis mode: turns off all diagnostic routines
<a name="l00216"></a>00216 
<a name="l00217"></a>00217   !  <a class="code" href="structtreevars_1_1particle.html">particle</a> data - dimensions filled in when #PEs known
<a name="l00218"></a>00218 
<a name="l00219"></a><a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">00219</a>   real*8, allocatable :: <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(:),  <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(:),  <a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(:), &amp;     ! position
<a name="l00220"></a><a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">00220</a>                       <a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(:), <a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(:), <a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(:), &amp;     ! velocity
<a name="l00221"></a><a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">00221</a>                               <a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(:),  <a class="code" href="namespacetreevars.html#6c12d2901c45a88c6f838e61074b3577">m</a>(:), &amp;     ! <a class="code" href="namespacetreevars.html#c635f0d036ac28a9d50d9a34ce023562">charge</a> and mass
<a name="l00222"></a><a class="code" href="namespacetreevars.html#5a7f29cfd6e9c687628d324991fecf3a">00222</a>                         <a class="code" href="namespacetreevars.html#965b464677536c91c1aa7d309b77487f">Ex</a>(:), <a class="code" href="namespacetreevars.html#eb08655fc8ee445e48c5c52cb334a4a3">Ey</a>(:), <a class="code" href="namespacetreevars.html#5a7f29cfd6e9c687628d324991fecf3a">Ez</a>(:), &amp;   ! E-field
<a name="l00223"></a><a class="code" href="namespacetreevars.html#7854e9096568a9ed5efc8ce23a9d463f">00223</a>                         <a class="code" href="namespacetreevars.html#7854e9096568a9ed5efc8ce23a9d463f">pot</a>(:), &amp;                ! scalar potential
<a name="l00224"></a><a class="code" href="namespacetreevars.html#4bdc671a5212a433823a458430605d7a">00224</a>                         <a class="code" href="namespacetreevars.html#23ddfaf21eda623491dd23e0b5c6c2ee">Axo</a>(:), <a class="code" href="namespacetreevars.html#1cdc5c7c6318f7b25c2429860b80a139">Ayo</a>(:), <a class="code" href="namespacetreevars.html#4bdc671a5212a433823a458430605d7a">Azo</a>(:), &amp;   ! vector potential
<a name="l00225"></a><a class="code" href="namespacetreevars.html#171e408a911b6cd414ecccb4d15e3f6c">00225</a>                         <a class="code" href="namespacetreevars.html#f8fc5bb4d3d3cf05020bdb2d2e095ad8">Ax</a>(:), <a class="code" href="namespacetreevars.html#f73e774b9f50a0c067fa7f496e7a41b8">Ay</a>(:), <a class="code" href="namespacetreevars.html#171e408a911b6cd414ecccb4d15e3f6c">Az</a>(:), &amp;   ! vector potential
<a name="l00226"></a><a class="code" href="namespacetreevars.html#9f10ba6e593eb3c9bd1a9988b4e11943">00226</a>                         <a class="code" href="namespacetreevars.html#e97659a717b3512a29ee1233e020d171">Bx</a>(:), <a class="code" href="namespacetreevars.html#79119f2404cff6869a7d60fe52fff85e">By</a>(:), <a class="code" href="namespacetreevars.html#9f10ba6e593eb3c9bd1a9988b4e11943">Bz</a>(:), &amp;   ! B-field
<a name="l00227"></a><a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">00227</a>                         <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a>(:)                  ! interaction <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a> load 
<a name="l00228"></a>00228 
<a name="l00229"></a><a class="code" href="namespacetreevars.html#cba952608d98a8f29384930ed9cd0b35">00229</a>   integer*8, allocatable ::   <a class="code" href="namespacetreevars.html#cba952608d98a8f29384930ed9cd0b35">pekey</a>(:), &amp;  ! local <a class="code" href="structtreevars_1_1particle.html">particle</a> keys                             
<a name="l00230"></a><a class="code" href="namespacetreevars.html#f99b61fd87d2273b634f6cb97c1f920c">00230</a>                               <a class="code" href="namespacetreevars.html#f99b61fd87d2273b634f6cb97c1f920c">intlist</a>(:,:) ! interaction key-list
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="namespacetreevars.html#6f1233e9ba9d5552e1b9dcec0fe6565d">00232</a>   integer, allocatable ::     <a class="code" href="namespacetreevars.html#6f1233e9ba9d5552e1b9dcec0fe6565d">pepid</a>(:), &amp; ! owner
<a name="l00233"></a><a class="code" href="namespacetreevars.html#745c67b70193cf25d51284647d7731d6">00233</a>                               <a class="code" href="namespacetreevars.html#745c67b70193cf25d51284647d7731d6">pelabel</a>(:), &amp;   ! <a class="code" href="structtreevars_1_1particle.html">particle</a> label
<a name="l00234"></a><a class="code" href="namespacetreevars.html#0c00c9ba3fcb9b5b155b47f4a1df1011">00234</a>                               <a class="code" href="namespacetreevars.html#0c00c9ba3fcb9b5b155b47f4a1df1011">nterm</a>(:), &amp;  ! # interactions 
<a name="l00235"></a><a class="code" href="namespacetreevars.html#038c4e890b46de1d1dce97658d24652c">00235</a>                               <a class="code" href="namespacetreevars.html#038c4e890b46de1d1dce97658d24652c">nodelist</a>(:,:) ! interaction key-list
<a name="l00236"></a>00236 
<a name="l00237"></a><a class="code" href="namespacetreevars.html#8966cacd9f750c25bb4d0a8980f4c63c">00237</a>   real, allocatable ::  <a class="code" href="namespacetreevars.html#8966cacd9f750c25bb4d0a8980f4c63c">work_loads</a>(:)  ! Load <a class="code" href="namelist_8h.html#2606f6bb46feacaea3f8c92db8f66a9c">balance</a> array
<a name="l00238"></a><a class="code" href="namespacetreevars.html#b1cd8806a298cde8bb9f8197ae7eb23c">00238</a>   integer, allocatable :: <a class="code" href="namespacetreevars.html#b1cd8806a298cde8bb9f8197ae7eb23c">npps</a>(:)  ! Particle distrib amoung PEs
<a name="l00239"></a><a class="code" href="namespacetreevars.html#f6ade0ddb16dec71ab9f6583a8d2745e">00239</a>   integer*8, allocatable ::  <a class="code" href="namespacetreevars.html#f6ade0ddb16dec71ab9f6583a8d2745e">pivots</a>(:)  ! Pivot buffer for sort
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 end module treevars
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 23 16:02:50 2007 for PEPC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7-20060810 </small></address>
</body>
</html>
