<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PEPC: randtest.f90 Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7-20060810 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_28272fc65e3d756317163f9acb2ad644.html">gibbon</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e3e416c1e3f7ebc92335d37fb0dd4777.html">pepc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_991097dbe07e9883c0a11fa77543783e.html">pepc-b</a></div>
<h1>randtest.f90</h1><a href="randtest_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 
<a name="l00004"></a><a class="code" href="namespacerantest.html">00004</a> program rantest
<a name="l00005"></a><a class="code" href="interfacerantest_1_1interface.html">00005</a>   <a class="code" href="interfacerantest_1_1interface.html">interface</a>
<a name="l00006"></a><a class="code" href="interfacerantest_1_1interface.html#6cdf50306a3d876204aa035c6b22047f">00006</a>      subroutine <a class="code" href="randtest_8f90.html#6cdf50306a3d876204aa035c6b22047f">times2</a>(k)
<a name="l00007"></a>00007        integer*4, intent(inout) :: k(:)
<a name="l00008"></a>00008      end subroutine <a class="code" href="randtest_8f90.html#6cdf50306a3d876204aa035c6b22047f">times2</a>
<a name="l00009"></a>00009   end <a class="code" href="interfacerantest_1_1interface.html">interface</a>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011   parameter (n=10)
<a name="l00012"></a><a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">00012</a>   integer*4 <a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>(n), <a class="code" href="namespacerantest.html#69537cdaaa1978b7e99049c574fe740e">iflag</a>
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="namespacerantest.html#0d461beb2c3e35040e0bb48a3480b7b8">00014</a>   real <a class="code" href="namespacerantest.html#57e18b26d24449e6afe0d206da3394ce">r</a>(n),<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(n)
<a name="l00015"></a>00015 
<a name="l00016"></a>00016   write (*,*) '<span class="preprocessor"># bits = ',bit_size(1)</span>
<a name="l00017"></a>00017 <span class="preprocessor"></span>
<a name="l00018"></a>00018   maxnumber = 2147483647
<a name="l00019"></a>00019   write (*,'(z10)') maxnumber
<a name="l00020"></a>00020     iseed = -74093875
<a name="l00021"></a>00021   do while(iseed.<a class="code" href="namelist_8h.html#c570850af67b707ee0fabd68903062f7">ne</a>.0)
<a name="l00022"></a>00022      write (*,*) 'Give seed:'
<a name="l00023"></a>00023      read (*,*) iseed
<a name="l00024"></a>00024      <a class="code" href="namespacerantest.html#69537cdaaa1978b7e99049c574fe740e">iflag</a> = 0
<a name="l00025"></a>00025      do i = 1, n
<a name="l00026"></a>00026 
<a name="l00027"></a>00027         <a class="code" href="namespacerantest.html#57e18b26d24449e6afe0d206da3394ce">r</a>(i) = <a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a> ( iseed )      ! 0-&gt; 1, <span class="keywordtype">double</span> precision
<a name="l00028"></a>00028      end do
<a name="l00029"></a>00029 
<a name="l00030"></a>00030      !  call <a class="code" href="randtest_8f90.html#6cdf50306a3d876204aa035c6b22047f">times2</a>(<a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>)
<a name="l00031"></a>00031 
<a name="l00032"></a>00032      write(*,'(i5,f20.16)') (i,<a class="code" href="namespacerantest.html#57e18b26d24449e6afe0d206da3394ce">r</a>(i),i=1,n)
<a name="l00033"></a>00033   end do
<a name="l00034"></a>00034 end program rantest
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="randtest_8f90.html#6cdf50306a3d876204aa035c6b22047f">00037</a> subroutine <a class="code" href="randtest_8f90.html#6cdf50306a3d876204aa035c6b22047f">times2</a>(k)
<a name="l00038"></a>00038 
<a name="l00039"></a>00039   integer*4, dimension(:) :: k
<a name="l00040"></a>00040   maxnumber = 2147483647/100
<a name="l00041"></a>00041 
<a name="l00042"></a>00042   k = k/maxnumber        ! return number between 1 and 100
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 end subroutine <a class="code" href="randtest_8f90.html#6cdf50306a3d876204aa035c6b22047f">times2</a>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 ! Random number scrambler
<a name="l00048"></a>00048 ! =======================
<a name="l00049"></a>00049 !
<a name="l00050"></a>00050 !  called with: 
<a name="l00051"></a>00051 !               <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>=<a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a>(iseed)
<a name="l00052"></a>00052 !
<a name="l00053"></a>00053 !  returns real number in the interval (0.0 - 1.0)
<a name="l00054"></a>00054 !  set iseed = -ve integer before using call
<a name="l00055"></a>00055 !
<a name="l00056"></a>00056 !  Example of calling routine:
<a name="l00057"></a>00057 !
<a name="l00058"></a>00058 !      subroutine coords
<a name="l00059"></a>00059 !      include 'common.h'
<a name="l00060"></a>00060 !
<a name="l00061"></a>00061 !      iseed1 = -11
<a name="l00062"></a>00062 !      iseed2 = -7
<a name="l00063"></a>00063 !
<a name="l00064"></a>00064 !
<a name="l00065"></a>00065 !      do i=1,n
<a name="l00066"></a>00066 !       <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i)=xlen*<a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a>(iseed1)
<a name="l00067"></a>00067 !       <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(i)=ylen*<a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a>(iseed2)
<a name="l00068"></a>00068 !      end do
<a name="l00069"></a>00069 !
<a name="l00070"></a>00070 !
<a name="l00071"></a>00071 !      end
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 ! - routine taken from Numerical Recipies, p195
<a name="l00075"></a>00075 !
<a name="l00076"></a><a class="code" href="randtest_8f90.html#cd64395f7f2d8a07dcedacaf0a9515b9">00076</a> function <a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a>(idum)
<a name="l00077"></a>00077   real dseed
<a name="l00078"></a>00078   dimension <a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>(97)
<a name="l00079"></a>00079   data iff,icall/0,0/
<a name="l00080"></a>00080   if (idum.lt.0.or.iff.eq.0) then
<a name="l00081"></a>00081      iff = 1
<a name="l00082"></a>00082      dseed=abs(idum)*1.0
<a name="l00083"></a>00083      idum=1
<a name="l00084"></a>00084      do  j=1,97
<a name="l00085"></a>00085         dum=<a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a>(dseed)
<a name="l00086"></a>00086      end do
<a name="l00087"></a>00087      do j=1,97
<a name="l00088"></a>00088         <a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>(j)=<a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a>(dseed)
<a name="l00089"></a>00089      end do
<a name="l00090"></a>00090      <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>=<a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a>(dseed)
<a name="l00091"></a>00091   endif
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   !  next index - make sure we don't overstep array bounds if
<a name="l00094"></a>00094   !  generator returns a 0.0 or 1.0
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   j=max(mod(1+<span class="keywordtype">int</span>(97.*<a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>),98),1)
<a name="l00097"></a>00097   if(j.gt.97.or.j.lt.1) then
<a name="l00098"></a>00098      write (6,*) 'Call: ',icall
<a name="l00099"></a>00099      write (6,*) 'idum = ',idum,'j = ',j,' y= ',y
<a name="l00100"></a>00100      write (6,*) 'Random No. generator not initialised properly'
<a name="l00101"></a>00101      write (6,*) 'dummy =',dum,' dseed=',dseed
<a name="l00102"></a>00102      write (6,100) (i,<a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>(i),i=1,97)
<a name="l00103"></a>00103 100  format (i4,f10.6)
<a name="l00104"></a>00104      stop
<a name="l00105"></a>00105   endif
<a name="l00106"></a>00106   !  get next variate and generate new one to fill gap
<a name="l00107"></a>00107 
<a name="l00108"></a>00108   y=<a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>(j)
<a name="l00109"></a>00109   <a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a>=y
<a name="l00110"></a>00110   <a class="code" href="namespacerantest.html#1b5a3c6d32a05457f6dbcacc13c956fe">v</a>(j)=<a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a>(dseed)
<a name="l00111"></a>00111   icall = icall + 1
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   return
<a name="l00114"></a>00114 end function <a class="code" href="namespaceutils.html#e35fe01ab5373722db624fcc320415e4">rano</a>
<a name="l00115"></a>00115 
<a name="l00116"></a>00116                                                                           
<a name="l00117"></a><a class="code" href="randtest_8f90.html#aa26d81d4a48203cdf2c285c6d73cf8e">00117</a> real function <a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a> (dseed)                                      
<a name="l00118"></a>00118 !                                  specifications for arguments         
<a name="l00119"></a>00119   real   dseed                                          
<a name="l00120"></a>00120 !                                  specifications for local variables   
<a name="l00121"></a>00121   real   d2p31m,d2p31                                   
<a name="l00122"></a>00122 !                                  d2p31m=(2**31) - 1                   
<a name="l00123"></a>00123 !                                  d2p31 =(2**31)(or an adjusted value) 
<a name="l00124"></a>00124   data               d2p31m/2147483647.0/                          
<a name="l00125"></a>00125   data               d2p31 /2147483648.0/                          
<a name="l00126"></a>00126 !                                  first executable statement           
<a name="l00127"></a>00127   dseed = mod(16807.0*dseed,d2p31m)                               
<a name="l00128"></a>00128   <a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a> = dseed / d2p31                                            
<a name="l00129"></a>00129   return                                                            
<a name="l00130"></a>00130 end function <a class="code" href="namespaceutils.html#d26bf9913a88f066220ac0e908cdf1a9">genran</a>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 23 16:02:50 2007 for PEPC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7-20060810 </small></address>
</body>
</html>
