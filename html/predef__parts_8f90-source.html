<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PEPC: predef_parts.f90 Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7-20060810 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Packages</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_28272fc65e3d756317163f9acb2ad644.html">gibbon</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_e3e416c1e3f7ebc92335d37fb0dd4777.html">pepc</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_991097dbe07e9883c0a11fa77543783e.html">pepc-b</a></div>
<h1>predef_parts.f90</h1><a href="predef__parts_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 ! ==============================================
<a name="l00002"></a>00002 !
<a name="l00003"></a>00003 !                PREDEF_PARTS
<a name="l00004"></a>00004 !
<a name="l00005"></a>00005 !  Read particle distribution from file
<a name="l00006"></a>00006 !
<a name="l00007"></a>00007 ! ==============================================
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="predef__parts_8f90.html#cd99d7cd580d3e95de5c28749be63471">00009</a> subroutine <a class="code" href="predef__parts_8f90.html#cd99d7cd580d3e95de5c28749be63471">predef_parts</a>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011   use physvars
<a name="l00012"></a>00012   use treevars
<a name="l00013"></a>00013   implicit none
<a name="l00014"></a>00014   include 'mpif.h'
<a name="l00015"></a>00015 
<a name="l00016"></a>00016   integer :: i, ipe, idummy, <a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018   character(30) :: cinfile, cdump, cfile
<a name="l00019"></a>00019   character(9) :: ct
<a name="l00020"></a>00020   character(11) :: cme
<a name="l00021"></a>00021   integer :: ner, nir, np_beamr, npartr, iconf, iens, timestamp
<a name="l00022"></a>00022   real :: epsr, thetar, xlr, ylr, zlr, boxr
<a name="l00023"></a>00023   real :: omegar, lambdar
<a name="l00024"></a>00024   real :: axdum, aydum, azdum,phidum, bdum
<a name="l00025"></a>00025   integer :: ioffset, i1, i2, npp_partial, npp_total, ipass, me_read, j, nrest, nadd
<a name="l00026"></a>00026   integer :: nslice_e, nslice_i
<a name="l00027"></a>00027 
<a name="l00028"></a>00028   if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a> == 0) then 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031      ! input file for PE <a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033      cinfile=<span class="stringliteral">"parts_info.in"</span>
<a name="l00034"></a>00034      open(80,file=cinfile)
<a name="l00035"></a>00035 
<a name="l00036"></a>00036      ! Root reads info block in run directory to check that run parameters correct
<a name="l00037"></a>00037 
<a name="l00038"></a>00038      read(80,'(7(9<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>,i8/),10(9<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>,f12.5/),9(9<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>,1pe12.5/),2(9<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>,3f12.5/))')  &amp;    ! info block - skip variable names
<a name="l00039"></a>00039           <a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>, npartr, &amp;
<a name="l00040"></a>00040           ner, nir, np_beamr, iconf, iens, &amp;
<a name="l00041"></a>00041           xlr, ylr, zlr, boxr, &amp;
<a name="l00042"></a>00042           epsr, thetar, &amp;
<a name="l00043"></a>00043           <a class="code" href="namespacephysvars.html#ce7ee718a38bd3f477f9ac537f245cdc">tlaser</a>, <a class="code" href="namespacephysvars.html#f7fa5a2635732bfa872faaf10f901450">trun</a>, omegar, lambdar, &amp;
<a name="l00044"></a>00044           <a class="code" href="namespacephysvars.html#660f77759b5a6e2cdb0d84fbea454316">qe</a>, <a class="code" href="namespacephysvars.html#6bdbc3c85d95127570179f88965c5db3">qi</a>, <a class="code" href="namespacephysvars.html#2944045ce0b8cf406828839a2e61efd0">mass_e</a>, <a class="code" href="namespacephysvars.html#b76e4caaac2dc9df8a2af1aaf10979fd">mass_i</a>, <a class="code" href="namelist_8h.html#e20fb86f913bc05e1aa5bd022543b8a6">Zion</a>, <a class="code" href="namespacephysvars.html#12475503cd099fb76e2a93fab616f798">a_ii</a>, <a class="code" href="namespacephysvars.html#40a958ee25625f4ceb7850ff54207714">Vplas</a>, <a class="code" href="namespacephysvars.html#bd3ef00da9082e85f7e93ab770c02753">Aplas</a>, <a class="code" href="namespacephysvars.html#f496963d8d4a8fe5a5a8ea1fbcd77dae">Qplas</a>, &amp;
<a name="l00045"></a>00045           <a class="code" href="namespacephysvars.html#571dce92e015cd998aa38c8dee7c36ac">plasma_centre</a>(1:3), <a class="code" href="namelist_8h.html#a729632262bf53dac77d4fbe3047cb44">focus</a>(1:3)
<a name="l00046"></a>00046      close(80)
<a name="l00047"></a>00047      write(6,'(/a/a/a,i5)') 'RESTART:','Reading run data from info block: parts_info.in','Timestep:',<a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049      if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>==0) write(*,'(7(a12,i12/),9(a12,f12.5/),9(a12,1pe12.5/),2(a12,3(1pe12.5)/))')  &amp;    ! info block - skip variable names
<a name="l00050"></a>00050           'Start time: ', <a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>, &amp; 
<a name="l00051"></a>00051           '# particles: ', npartr, &amp;
<a name="l00052"></a>00052           '# electrons: ', ner, &amp;
<a name="l00053"></a>00053           '# ions: ', nir, &amp; 
<a name="l00054"></a>00054           '# <a class="code" href="beam_8f90.html#237ea3870e5d133929260457ba33d476">beam</a>: ', np_beamr, &amp;
<a name="l00055"></a>00055           'Geom  : ', iconf, &amp; 
<a name="l00056"></a>00056           'Scheme: ', iens, &amp;
<a name="l00057"></a>00057           'Box_x: ',xlr,&amp;
<a name="l00058"></a>00058           'Box_y: ', ylr, &amp;
<a name="l00059"></a>00059           'Box_z: ', zlr, &amp;
<a name="l00060"></a>00060           '<a class="code" href="namelist_8h.html#3d5b0f2d79621403cfab74bce3469eb1">eps</a>: ', <a class="code" href="namelist_8h.html#3d5b0f2d79621403cfab74bce3469eb1">eps</a>,  &amp;
<a name="l00061"></a>00061           '<a class="code" href="namelist_8h.html#2debd5e81fbe9e3985b18628f622d180">theta</a>: ', thetar, &amp;
<a name="l00062"></a>00062           '<a class="code" href="namespacephysvars.html#ce7ee718a38bd3f477f9ac537f245cdc">tlaser</a>: ',<a class="code" href="namespacephysvars.html#ce7ee718a38bd3f477f9ac537f245cdc">tlaser</a>, &amp;
<a name="l00063"></a>00063           '<a class="code" href="namespacephysvars.html#f7fa5a2635732bfa872faaf10f901450">trun</a>: ',<a class="code" href="namespacephysvars.html#f7fa5a2635732bfa872faaf10f901450">trun</a>, &amp;
<a name="l00064"></a>00064           '<a class="code" href="namelist_8h.html#630bc314dbc10cc6306033525170d456">omega</a>:',omegar, &amp;
<a name="l00065"></a>00065           '<a class="code" href="namelist_8h.html#e3d8df362ba9db761c5b2c3c47bd26f5">lambda</a>:', lambdar, &amp;
<a name="l00066"></a>00066           '<a class="code" href="namespacephysvars.html#660f77759b5a6e2cdb0d84fbea454316">qe</a>:',<a class="code" href="namespacephysvars.html#660f77759b5a6e2cdb0d84fbea454316">qe</a>, &amp;
<a name="l00067"></a>00067           '<a class="code" href="namespacephysvars.html#6bdbc3c85d95127570179f88965c5db3">qi</a>:',<a class="code" href="namespacephysvars.html#6bdbc3c85d95127570179f88965c5db3">qi</a>, &amp;
<a name="l00068"></a>00068           '<a class="code" href="namespacephysvars.html#2944045ce0b8cf406828839a2e61efd0">mass_e</a>:',<a class="code" href="namespacephysvars.html#2944045ce0b8cf406828839a2e61efd0">mass_e</a>, &amp;
<a name="l00069"></a>00069           '<a class="code" href="namespacephysvars.html#b76e4caaac2dc9df8a2af1aaf10979fd">mass_i</a>:',<a class="code" href="namespacephysvars.html#b76e4caaac2dc9df8a2af1aaf10979fd">mass_i</a>, &amp;
<a name="l00070"></a>00070           '<a class="code" href="namelist_8h.html#e20fb86f913bc05e1aa5bd022543b8a6">Zion</a>:',<a class="code" href="namelist_8h.html#e20fb86f913bc05e1aa5bd022543b8a6">Zion</a>, &amp;
<a name="l00071"></a>00071           '<a class="code" href="namespacephysvars.html#12475503cd099fb76e2a93fab616f798">a_ii</a>:', <a class="code" href="namespacephysvars.html#12475503cd099fb76e2a93fab616f798">a_ii</a>, &amp;
<a name="l00072"></a>00072           '<a class="code" href="namespacephysvars.html#40a958ee25625f4ceb7850ff54207714">Vplas</a>: ',<a class="code" href="namespacephysvars.html#40a958ee25625f4ceb7850ff54207714">Vplas</a>, &amp;
<a name="l00073"></a>00073           '<a class="code" href="namespacephysvars.html#bd3ef00da9082e85f7e93ab770c02753">Aplas</a>: ',<a class="code" href="namespacephysvars.html#bd3ef00da9082e85f7e93ab770c02753">Aplas</a>, &amp;
<a name="l00074"></a>00074           '<a class="code" href="namespacephysvars.html#f496963d8d4a8fe5a5a8ea1fbcd77dae">Qplas</a>: ',<a class="code" href="namespacephysvars.html#f496963d8d4a8fe5a5a8ea1fbcd77dae">Qplas</a>, &amp;
<a name="l00075"></a>00075           'centre: ',<a class="code" href="namespacephysvars.html#571dce92e015cd998aa38c8dee7c36ac">plasma_centre</a>(1:3), &amp;
<a name="l00076"></a>00076           '<a class="code" href="namelist_8h.html#a729632262bf53dac77d4fbe3047cb44">focus</a>: ',<a class="code" href="namelist_8h.html#a729632262bf53dac77d4fbe3047cb44">focus</a>(1:3)
<a name="l00077"></a>00077 
<a name="l00078"></a>00078      if (ner /= <a class="code" href="namelist_8h.html#c570850af67b707ee0fabd68903062f7">ne</a> .or. nir /= <a class="code" href="namelist_8h.html#a4fb44be053c6d3f35c09963f7ac2ecc">ni</a>) then
<a name="l00079"></a>00079         write(*,*) '*** Particle nos. in input deck do not match those in <a class="code" href="namelist_8h.html#2bdedf3cae2a62acd8af28e53daed9c0">restart</a> file parts_info.in'
<a name="l00080"></a>00080         stop
<a name="l00081"></a>00081      endif
<a name="l00082"></a>00082 
<a name="l00083"></a>00083      if (epsr /= <a class="code" href="namelist_8h.html#3d5b0f2d79621403cfab74bce3469eb1">eps</a>) then
<a name="l00084"></a>00084         write(*,*) '*** Warning: potential cutoff <a class="code" href="namelist_8h.html#3d5b0f2d79621403cfab74bce3469eb1">eps</a> changed - check inputs'
<a name="l00085"></a>00085      endif
<a name="l00086"></a>00086 
<a name="l00087"></a>00087      if (thetar /= <a class="code" href="namelist_8h.html#2debd5e81fbe9e3985b18628f622d180">theta</a>) then
<a name="l00088"></a>00088         write(*,*) '*** Warning: MAC changed - check inputs'
<a name="l00089"></a>00089      endif
<a name="l00090"></a>00090 
<a name="l00091"></a>00091      if (iconf /= <a class="code" href="namelist_8h.html#65b106175d5c7acd554c1bce2595f2a8">target_geometry</a>) then
<a name="l00092"></a>00092         write(*,*) '*** Warning: Target geometry in <a class="code" href="namelist_8h.html#2bdedf3cae2a62acd8af28e53daed9c0">restart</a> file ',iconf, &amp;
<a name="l00093"></a>00093              ' does not match value ',<a class="code" href="namelist_8h.html#65b106175d5c7acd554c1bce2595f2a8">target_geometry</a>,' in run.h - check inputs'
<a name="l00094"></a>00094      endif
<a name="l00095"></a>00095   endif
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   call MPI_BARRIER( MPI_COMM_WORLD, <a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)   ! Synchronize first
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   call MPI_BCAST( <a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>, 1, MPI_INTEGER, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00102"></a>00102   call MPI_BCAST( <a class="code" href="namelist_8h.html#b8c12579d5380e3cd3777e1c2a43d242">xl</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00103"></a>00103   call MPI_BCAST( <a class="code" href="namelist_8h.html#920848accbcb0bcb52d1d0d8c31eda24">yl</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00104"></a>00104   call MPI_BCAST( <a class="code" href="namelist_8h.html#6fd88682b343fc37fa3c1e56f0c3a194">zl</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00105"></a>00105   call MPI_BCAST( <a class="code" href="namespacetreevars.html#8b7d0bfaafb4911e08470411d32719f7">boxsize</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00106"></a>00106   call MPI_BCAST( <a class="code" href="namelist_8h.html#2debd5e81fbe9e3985b18628f622d180">theta</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00107"></a>00107   call MPI_BCAST( <a class="code" href="namelist_8h.html#3d5b0f2d79621403cfab74bce3469eb1">eps</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00108"></a>00108   call MPI_BCAST( <a class="code" href="namespacephysvars.html#f7fa5a2635732bfa872faaf10f901450">trun</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00109"></a>00109   call MPI_BCAST( <a class="code" href="namespacephysvars.html#ce7ee718a38bd3f477f9ac537f245cdc">tlaser</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00110"></a>00110   call MPI_BCAST( <a class="code" href="namespacephysvars.html#660f77759b5a6e2cdb0d84fbea454316">qe</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00111"></a>00111   call MPI_BCAST( <a class="code" href="namespacephysvars.html#6bdbc3c85d95127570179f88965c5db3">qi</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00112"></a>00112   call MPI_BCAST( <a class="code" href="namespacephysvars.html#2944045ce0b8cf406828839a2e61efd0">mass_e</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00113"></a>00113   call MPI_BCAST( <a class="code" href="namespacephysvars.html#b76e4caaac2dc9df8a2af1aaf10979fd">mass_i</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00114"></a>00114   call MPI_BCAST( <a class="code" href="namelist_8h.html#e20fb86f913bc05e1aa5bd022543b8a6">Zion</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00115"></a>00115   call MPI_BCAST( <a class="code" href="namespacephysvars.html#12475503cd099fb76e2a93fab616f798">a_ii</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00116"></a>00116   call MPI_BCAST( <a class="code" href="namespacephysvars.html#40a958ee25625f4ceb7850ff54207714">Vplas</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00117"></a>00117   call MPI_BCAST( <a class="code" href="namespacephysvars.html#bd3ef00da9082e85f7e93ab770c02753">Aplas</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00118"></a>00118   call MPI_BCAST( <a class="code" href="namespacephysvars.html#f496963d8d4a8fe5a5a8ea1fbcd77dae">Qplas</a>, 1, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00119"></a>00119   call MPI_BCAST( <a class="code" href="namespacephysvars.html#571dce92e015cd998aa38c8dee7c36ac">plasma_centre</a>, 3, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00120"></a>00120   call MPI_BCAST( <a class="code" href="namelist_8h.html#a729632262bf53dac77d4fbe3047cb44">focus</a>, 3, MPI_REAL, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00121"></a>00121   call MPI_BCAST( <a class="code" href="namelist_8h.html#c570850af67b707ee0fabd68903062f7">ne</a>, 1, MPI_INTEGER, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00122"></a>00122   call MPI_BCAST( <a class="code" href="namelist_8h.html#a4fb44be053c6d3f35c09963f7ac2ecc">ni</a>, 1, MPI_INTEGER, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00123"></a>00123   call MPI_BCAST( <a class="code" href="namespacetreevars.html#ac21a2dc42e5595e66cba603534873bd">npart</a>, 1, MPI_INTEGER, 0, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   if (<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a> &lt; 0 ) then
<a name="l00126"></a>00126 
<a name="l00127"></a>00127      ! <a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a> &gt; # data sets, so carve up <a class="code" href="namelist_8h.html#2bdedf3cae2a62acd8af28e53daed9c0">restart</a> data
<a name="l00128"></a>00128 
<a name="l00129"></a>00129      if (<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a> == -1) then
<a name="l00130"></a>00130         <a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a> = <a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a>  ! automatic splitting of single data set
<a name="l00131"></a>00131      else
<a name="l00132"></a>00132         <a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a> = -<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>  ! split several sets
<a name="l00133"></a>00133      endif
<a name="l00134"></a>00134 
<a name="l00135"></a>00135      if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>==0) write (*,*) 'Splitting sets by 1:',<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>
<a name="l00136"></a>00136 
<a name="l00137"></a>00137      ! Filename (directory) prefix
<a name="l00138"></a>00138      me_read = <a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>/<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>
<a name="l00139"></a>00139      cme = <span class="stringliteral">"data/pe"</span> &amp;   
<a name="l00140"></a>00140        <span class="comment">// achar(me_read/1000+48) &amp;</span>
<a name="l00141"></a>00141        <span class="comment">// achar(mod(me_read/100,10)+48) &amp;</span>
<a name="l00142"></a>00142        <span class="comment">// achar(mod(me_read/10,10)+48) &amp;</span>
<a name="l00143"></a>00143        <span class="comment">// achar(mod(me_read,10)+48)  ! Convert 4-digit PE number into character string</span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145      ! get filename suffix from <a class="code" href="dump_8f90.html#88b597631f796e2b06c577e64bd94fe9">dump</a> counter
<a name="l00146"></a>00146      do i=0,4
<a name="l00147"></a>00147         cdump(6-i:6-i) =  achar(mod(<a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>/10**i,10) + 48)  
<a name="l00148"></a>00148      end do
<a name="l00149"></a>00149      cdump(1:1) = achar(<a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>/10**5 + 48)
<a name="l00150"></a>00150 
<a name="l00151"></a>00151      cfile=cme<span class="comment">//"/parts_info."//cdump(1:6)</span>
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 
<a name="l00154"></a>00154      open (60,file=cfile)    
<a name="l00155"></a>00155      read(60,'(2(9<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>,i8/))')  timestamp,npp_total  ! Find # particles to be read 
<a name="l00156"></a>00156      close(60)
<a name="l00157"></a>00157      if (<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>==<a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a>) npp_total = <a class="code" href="namelist_8h.html#c570850af67b707ee0fabd68903062f7">ne</a>+<a class="code" href="namelist_8h.html#a4fb44be053c6d3f35c09963f7ac2ecc">ni</a>  ! Override total # if dataset to be split amoung all PEs
<a name="l00158"></a>00158      <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a> = npp_total/<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>
<a name="l00159"></a>00159      nrest = mod(npp_total,<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>)  ! Remainder
<a name="l00160"></a>00160 
<a name="l00161"></a>00161      if (mod(<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>,<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>)==<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>-1) then
<a name="l00162"></a>00162         nadd = nrest  ! Put remainder on last PE
<a name="l00163"></a>00163      else
<a name="l00164"></a>00164         nadd = 0
<a name="l00165"></a>00165      endif
<a name="l00166"></a>00166 
<a name="l00167"></a>00167      write(*,*) 'PE ',<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>,': Reading ',<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>+nadd,' particles out of ',npp_total,' from ',cme
<a name="l00168"></a>00168      cfile=cme<span class="comment">//"/parts_dump."//cdump(1:6)</span>
<a name="l00169"></a>00169      open (60,file=cfile) 
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 
<a name="l00173"></a>00173      !  Skip dummy blocks up to previous PEs 
<a name="l00174"></a>00174      nslice_e=0
<a name="l00175"></a>00175      nslice_i = 0
<a name="l00176"></a>00176      <a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a> = 0
<a name="l00177"></a>00177      do j=0,mod(<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>,<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>)-1
<a name="l00178"></a>00178         if (<a class="code" href="namelist_8h.html#79d8c3e2761fc8654683dc3f97e58e25">debug_level</a>&gt;0) write(<a class="code" href="namespacetreevars.html#0d5a9df9963aed1fb9d6ac000ba861f1">ipefile</a>,*) 'skip pass ',j
<a name="l00179"></a>00179         do i=1,<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>
<a name="l00180"></a>00180            read(60,*) <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i),<a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(i),<a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(i),<a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(i),<a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(i),<a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(i),<a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(i),<a class="code" href="namespacetreevars.html#6c12d2901c45a88c6f838e61074b3577">m</a>(i), &amp;
<a name="l00181"></a>00181                 axdum,aydum,azdum,phidum, idummy,<a class="code" href="namespacetreevars.html#745c67b70193cf25d51284647d7731d6">pelabel</a>(i)
<a name="l00182"></a>00182            if (<a class="code" href="namespacephysvars.html#1ff60eac6a083e1ac61c674793e352cc">beam_config</a>.eq.5 .and. <a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(i)&gt;0 .and. <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i) &lt; <a class="code" href="namespacephysvars.html#0209995b08a589a13437aa5029b56411">window_min</a>+<a class="code" href="namelist_8h.html#a3753cec73bb5fd57684e7692a606f05">dt</a> .and. <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i) &gt; <a class="code" href="namespacephysvars.html#0209995b08a589a13437aa5029b56411">window_min</a>) then
<a name="l00183"></a>00183   ! create rezoning slice for wakefield mode - first few blocks should be sufficient
<a name="l00184"></a>00184               <a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a> = <a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>+1
<a name="l00185"></a>00185               <a class="code" href="namespacephysvars.html#0e97c4ec26a828bbd295ec0fa22c9ba8">xslice</a>(<a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>) = <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i)+<a class="code" href="namelist_8h.html#12ab60c2ad9358d336db6643fd3460ba">x_plasma</a> ! Include offset for new slice
<a name="l00186"></a>00186               <a class="code" href="namespacephysvars.html#d8610c1a1089552ac1e3492889a714c2">yslice</a>(<a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>) = <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(i)
<a name="l00187"></a>00187               <a class="code" href="namespacephysvars.html#ca1ae673c77947b9bb85dd65cecbbfd1">zslice</a>(<a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>) = <a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(i)
<a name="l00188"></a>00188            endif
<a name="l00189"></a>00189         end do
<a name="l00190"></a>00190      end do
<a name="l00191"></a>00191 
<a name="l00192"></a>00192      !  Now read in particles to keep
<a name="l00193"></a>00193      read(60,*) (<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i),<a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(i),<a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(i),<a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(i),<a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(i),<a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(i),<a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(i),<a class="code" href="namespacetreevars.html#6c12d2901c45a88c6f838e61074b3577">m</a>(i),axdum,aydum,azdum,phidum, &amp;
<a name="l00194"></a>00194           idummy,<a class="code" href="namespacetreevars.html#745c67b70193cf25d51284647d7731d6">pelabel</a>(i),i=1,<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>+nadd)
<a name="l00195"></a>00195      close (60)
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 !     if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>==<a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a>-1 .and. debug&gt;0)  write(<a class="code" href="namespacetreevars.html#0d5a9df9963aed1fb9d6ac000ba861f1">ipefile</a>,'(a,i8/3(f15.5))') 'Slice  ions:', <a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>, &amp;
<a name="l00198"></a>00198 !          (<a class="code" href="namespacephysvars.html#0e97c4ec26a828bbd295ec0fa22c9ba8">xslice</a>(i),<a class="code" href="namespacephysvars.html#d8610c1a1089552ac1e3492889a714c2">yslice</a>(i),<a class="code" href="namespacephysvars.html#ca1ae673c77947b9bb85dd65cecbbfd1">zslice</a>(i),i=1,<a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>)
<a name="l00199"></a>00199      <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a> = <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>+nadd
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   else
<a name="l00202"></a>00202      ! <a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a> &lt; # data sets, so merge together
<a name="l00203"></a>00203 
<a name="l00204"></a>00204      ioffset = 0
<a name="l00205"></a>00205      <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a> = 0
<a name="l00206"></a>00206      if (<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>&gt;1) write (*,*) 'Merging sets by ',<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>,' : 1'
<a name="l00207"></a>00207 
<a name="l00208"></a>00208      do ipass = 0, <a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a>-1
<a name="l00209"></a>00209         me_read = <a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>*<a class="code" href="namelist_8h.html#f73d89ea7ac6d6c9aae07e9d68afdf76">ncpu_merge</a> + ipass
<a name="l00210"></a>00210         ! Filename (directory) prefix
<a name="l00211"></a>00211         cme = <span class="stringliteral">"data/pe"</span> &amp;   
<a name="l00212"></a>00212        <span class="comment">// achar(me_read/1000+48) &amp;</span>
<a name="l00213"></a>00213        <span class="comment">// achar(mod(me_read/100,10)+48) &amp;</span>
<a name="l00214"></a>00214        <span class="comment">// achar(mod(me_read/10,10)+48) &amp;</span>
<a name="l00215"></a>00215        <span class="comment">// achar(mod(me_read,10)+48)  ! Convert 4-digit PE number into character string</span>
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         write(*,'(a,a,a6,i8)') 'Reading from ',cme,'<a class="code" href="namespacephysvars.html#c125a4e0d163ae9c82706249ee8ddee4">itime</a>',<a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>
<a name="l00218"></a>00218         ! get filename suffix from <a class="code" href="dump_8f90.html#88b597631f796e2b06c577e64bd94fe9">dump</a> counter
<a name="l00219"></a>00219         do i=0,4
<a name="l00220"></a>00220            cdump(6-i:6-i) =  achar(mod(<a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>/10**i,10) + 48)  
<a name="l00221"></a>00221         end do
<a name="l00222"></a>00222         cdump(1:1) = achar(<a class="code" href="namespacephysvars.html#35b069b237be060c93579f29eb66a91d">itime_start</a>/10**5 + 48)
<a name="l00223"></a>00223 
<a name="l00224"></a>00224         cfile=cme<span class="comment">//"/parts_info."//cdump(1:6)</span>
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 
<a name="l00227"></a>00227         open (60,file=cfile)    
<a name="l00228"></a>00228         read(60,'(2(9<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>,i8/))')  timestamp,npp_partial  ! Find # particles to be read 
<a name="l00229"></a>00229         close(60)
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         cfile=cme<span class="comment">//"/parts_dump."//cdump(1:6)</span>
<a name="l00233"></a>00233         open (60,file=cfile) 
<a name="l00234"></a>00234 
<a name="l00235"></a>00235         i1 = ioffset + 1
<a name="l00236"></a>00236         i2 = ioffset + npp_partial
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         !  Initialise particles: read from file
<a name="l00239"></a>00239         read(60,*) (<a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(i),<a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(i),<a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(i),<a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(i),<a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(i),<a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(i),<a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(i),<a class="code" href="namespacetreevars.html#6c12d2901c45a88c6f838e61074b3577">m</a>(i),axdum,aydum,azdum,phidum, &amp;
<a name="l00240"></a>00240              idummy,<a class="code" href="namespacetreevars.html#745c67b70193cf25d51284647d7731d6">pelabel</a>(i),i=i1,i2)
<a name="l00241"></a>00241 
<a name="l00242"></a>00242         close (60)
<a name="l00243"></a>00243 
<a name="l00244"></a>00244         ioffset = ioffset + npp_partial
<a name="l00245"></a>00245         <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a> = <a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a> + npp_partial
<a name="l00246"></a>00246      enddo
<a name="l00247"></a>00247 
<a name="l00248"></a>00248   endif
<a name="l00249"></a>00249   call MPI_BARRIER( MPI_COMM_WORLD, <a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)   ! Synchronize first
<a name="l00250"></a>00250   call MPI_BCAST( <a class="code" href="namespacephysvars.html#5fcfba58fcc6cef0e7621bf381138387">nslice</a>, 1, MPI_INTEGER, <a class="code" href="namespacetreevars.html#694640a77e3d8236c59add8bfa3c133b">num_pe</a>-1, MPI_COMM_WORLD,<a class="code" href="namespacepepcb.html#a0d18ab20b16a2f6f7ea2d6b62caab43">ierr</a>)
<a name="l00251"></a>00251 
<a name="l00252"></a>00252   ! add displacement vector
<a name="l00253"></a>00253   !  <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = <a class="code" href="namespacetreevars.html#466130ce7b2fb1b56c99a0524b270b70">x</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) + <a class="code" href="namelist_8h.html#22ace8f7f39e70394531379810914a19">displace</a>(1)
<a name="l00254"></a>00254   !  <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = <a class="code" href="namespacetreevars.html#5ca0fa6d04b09531b6c4c55c545bde27">y</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) + <a class="code" href="namelist_8h.html#22ace8f7f39e70394531379810914a19">displace</a>(2)
<a name="l00255"></a>00255   !  <a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = <a class="code" href="namespacetreevars.html#a73b1827f715edeb1801dbd9ea9bd930">z</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) + <a class="code" href="namelist_8h.html#22ace8f7f39e70394531379810914a19">displace</a>(3)
<a name="l00256"></a>00256 
<a name="l00257"></a>00257   <a class="code" href="namespacetreevars.html#6f1233e9ba9d5552e1b9dcec0fe6565d">pepid</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = <a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>                ! processor ID
<a name="l00258"></a>00258 
<a name="l00259"></a>00259   <a class="code" href="namespacetreevars.html#965b464677536c91c1aa7d309b77487f">Ex</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = 0.       ! zero fields until first force comp.
<a name="l00260"></a>00260   <a class="code" href="namespacetreevars.html#eb08655fc8ee445e48c5c52cb334a4a3">Ey</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = 0.
<a name="l00261"></a>00261   <a class="code" href="namespacetreevars.html#5a7f29cfd6e9c687628d324991fecf3a">Ez</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = 0.
<a name="l00262"></a>00262   <a class="code" href="namespacetreevars.html#d1a1c1c00c2c454aaa4f00071b9f5d63">work</a>(1:<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>) = 1.
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   ! Rescale <a class="code" href="velocities_8f90.html#796291391239757f01e2b4e3b6b27650">velocities</a> if different temperature required 
<a name="l00265"></a>00265   if (<a class="code" href="namelist_8h.html#215b9ad132c42fb55c7a74ca3ec32c34">T_scale</a> /= 1) then
<a name="l00266"></a>00266      if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>==0) write(*,*) 'Rescaling temperature by ',<a class="code" href="namelist_8h.html#215b9ad132c42fb55c7a74ca3ec32c34">T_scale</a>,' to ',<a class="code" href="namelist_8h.html#429f260c120e70994f1e7a588e8b776e">Te_keV</a>
<a name="l00267"></a>00267      do i=1,<a class="code" href="namespacetreevars.html#46a9849e874a74f8747a37e0c76910c7">npp</a>
<a name="l00268"></a>00268         if (<a class="code" href="namespacetreevars.html#b9d8e8e7c77d33688592fb8fc698342f">q</a>(i)&lt;0) then
<a name="l00269"></a>00269            <a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(i) = <a class="code" href="namespacetreevars.html#4b80abeb37dca0426ceec7dd7e914454">ux</a>(i)*sqrt(<a class="code" href="namelist_8h.html#215b9ad132c42fb55c7a74ca3ec32c34">T_scale</a>)
<a name="l00270"></a>00270            <a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(i) = <a class="code" href="namespacetreevars.html#091b9d7991d39847f53ba7abd87ec1d4">uy</a>(i)*sqrt(<a class="code" href="namelist_8h.html#215b9ad132c42fb55c7a74ca3ec32c34">T_scale</a>)
<a name="l00271"></a>00271            <a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(i) = <a class="code" href="namespacetreevars.html#3b14c2f77b072cc356b49d5163e12f36">uz</a>(i)*sqrt(<a class="code" href="namelist_8h.html#215b9ad132c42fb55c7a74ca3ec32c34">T_scale</a>)
<a name="l00272"></a>00272         endif
<a name="l00273"></a>00273      end do
<a name="l00274"></a>00274   endif
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 if (<a class="code" href="namespacetreevars.html#f0c1ebe7c983f1b1061d88e367afc933">me</a>==0) write(*,*) <span class="stringliteral">"Finished reading in particle data"</span> 
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 end subroutine <a class="code" href="predef__parts_8f90.html#cd99d7cd580d3e95de5c28749be63471">predef_parts</a>
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 23 16:02:50 2007 for PEPC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7-20060810 </small></address>
</body>
</html>
